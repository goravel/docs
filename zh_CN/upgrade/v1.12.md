# ä» v1.11 å‡çº§åˆ° v1.12

## v1.12.6

### Bug ä¿®å¤ ğŸ›

- [ä¿®å¤ JWT é—®é¢˜](#fix-the-problem-of-jwt)

## v1.12.5

### Bug ä¿®å¤ ğŸ›

- [ä¿®å¤ facades.Orm().Query().Load() é—®é¢˜](#fix-the-problem-of-facades-orm-query-load)

## v1.12.4

### Bug ä¿®å¤ ğŸ›

- [Throttle ä¸­é—´ä»¶æŠ›å‡º Panic çš„é—®é¢˜](#the-problem-of-the-throttle-middleware-throw-panic)

## v1.12.3

### Bug ä¿®å¤ ğŸ›

- [Windows ä¸‹ make:package å‘½ä»¤çš„é—®é¢˜](#the-problem-of-make-package-command-under-windows)

## v1.12.2

### Bug ä¿®å¤ ğŸ›

- [facades.Gate() è¿”å› nil çš„é—®é¢˜](#the-problem-of-facades-gate-return-nil)

## v1.12.1

### Bug ä¿®å¤ ğŸ›

- [Windows ä¸‹æ–‡ä»¶è·¯å¾„å¯¼è‡´çš„ Panic é—®é¢˜](#the-panic-problem-caused-by-file-path-under-windows)

## v1.12.0

### ä»¤äººå…´å¥‹çš„æ–°åŠŸèƒ½ ğŸ‰

- [æœåŠ¡å®¹å™¨(1.12.0)](#service-container)
- [åŒ…å¼€å‘(1.12.0)](#package-development)
- [æ·»åŠ Carbonæ¨¡å—](#add-helpers-methods)

## å¢å¼ºåŠŸèƒ½ ğŸš€

- [Artisanæ ‡å¿—æ·»åŠ æ–°æ–¹æ³•](#artisan-flag-adds-new-methods)
- [æ·»åŠ è¾…åŠ©æ–¹æ³•](#add-helpers-methods)
- [å‡çº§ä¾èµ–](#upgrade-dependencies)
- [è¿ç§»æ·»åŠ æ–°æ–¹æ³•](#migration-adds-new-methods)
- [ä¸€äº› `make` å‘½ä»¤æ”¯æŒå­ç›®å½•](#some-make-commands-support-subdirectories)

## ç ´åæ€§å˜æ›´ ğŸ› 

- [ä¿®æ”¹Facadesçš„è°ƒç”¨æ–¹å¼(1.12.0)](#_3-modify-facades)
- [ä¼˜åŒ–Artisanæ ‡å¿—(1.12.0)](#_6-modify-flag-in-the-artisan-command-if-using)
- [æ–‡ä»¶ç³»ç»Ÿæ¨¡å—å–æ¶ˆå¯¹S3ã€OSSã€COSã€Minioçš„é»˜è®¤æ”¯æŒ](#_7-filesystem-module-cancels-default-support-for-s3-oss-cos-minio)
- [ç¼“å­˜æ¨¡å—å–æ¶ˆå¯¹Redisçš„é»˜è®¤æ”¯æŒ](#_8-cache-module-cancels-default-support-for-redis)
- [æ›´æ”¹æ¨¡å‹ä¸­CreatedAtã€UpdatedAtçš„ç±»å‹](#_9-change-the-type-of-createdat-updatedat-in-model)
- [ä¼˜åŒ–éªŒè¯æ¨¡å—çš„è§„åˆ™](#_10-optimize-the-rule-of-validation-module)

## å‡çº§æŒ‡å—

è¯·æŒ‰ç…§æœ¬èŠ‚å†…å®¹é€æ­¥å‡çº§æ¡†æ¶ã€‚

**é¢„è®¡å‡çº§æ—¶é—´ï¼š30åˆ†é’Ÿ**

### 1. 1ã€‚ æ›´æ–°ä¾èµ–

æ›´æ–°`go.mod`æ–‡ä»¶ä¸­çš„ä¾èµ–ï¼š

```
go get -u github.com/goravel/framework@v1.12.0 && go mod tidy
```

è¿è¡Œ `go mod tidy` åå‡ºç°é”™è¯¯ï¼Œå®Œæˆä»¥ä¸‹å‡çº§æ­¥éª¤åå°†è§£å†³è¯¥é”™è¯¯ã€‚

### 2. 2ã€‚ ä¿®æ”¹ `bootstrap/app.go`

```go
// ä¿®æ”¹å‰
app := foundation.Application{}

// ä¿®æ”¹å
app := foundation.NewApplication()
```

### 3. 3ã€‚ ä¿®æ”¹ facades.\*

| ä¿®æ”¹å‰                   | After                   |
| --------------------- | ----------------------- |
| `facades.Artisan`     | `facades.Artisan()`     |
| `facades.Auth`        | `facades.Auth()`        |
| `facades.Cache`       | `facades.Cache()`       |
| `facades.Config`      | `facades.Config()`      |
| `facades.Crypt`       | `facades.Crypt()`       |
| `facades.Event`       | `facades.Event()`       |
| `facades.Gate`        | `facades.Gate()`        |
| `facades.Grpc`        | `facades.Grpc()`        |
| `facades.Hash`        | `facades.Hash()`        |
| `facades.Log`         | `facades.Log()`         |
| `facades.Mail`        | `facades.Mail()`        |
| `facades.Orm`         | `facades.Orm()`         |
| `facades.Queue`       | `facades.Queue()`       |
| `facades.RateLimiter` | `facades.RateLimiter()` |
| `facades.Route`       | `facades.Route()`       |
| `facades.Schedule`    | `facades.Schedule()`    |
| `facades.Storage`     | `facades.Storage()`     |
| `facades.Validation`  | `facades.Validation()`  |

### 4. 4ã€‚ ä¿®æ”¹ `app/providers/*`

ä¸ºæ‰€æœ‰æ–‡ä»¶æ·»åŠ å¯¼å…¥ï¼š

```go
import (
  "github.com/goravel/framework/contracts/foundation"
)
```

æ‰€æœ‰çš„ `Register`ã€`Boot` æ–¹æ³•æ·»åŠ  `app foundation.Application` è¾“å…¥å‚æ•°ï¼š

```go
func (receiver *AppServiceProvider) Register(app foundation.Application) {}

func (receiver *AppServiceProvider) Boot(app foundation.Application) {}
```

### 5. 5ã€‚ ä¿®æ”¹ `app/config/app.go`

ä¿®æ”¹å¯¼å…¥ï¼š

```go
// ä¿®æ”¹å‰
"github.com/goravel/framework/contracts"

"providers": []contracts.ServiceProvider{

// ä¿®æ”¹å
"github.com/goravel/framework/contracts/foundation"

"providers": []foundation.ServiceProvider{
```

### 6. 6ã€‚ ä¿®æ”¹ Artisan å‘½ä»¤ä¸­çš„ Flagï¼ˆå¦‚æœä½¿ç”¨ï¼‰

åœ¨ `[]command.Flag` ä¸­æ·»åŠ  `&command.StringFlag` ç±»å‹ï¼š

```go
// ä¿®æ”¹å‰
func (receiver *VendorPublishCommand) Extend() command.Extend {
  return command.Extend{
    Category: "test",
    Flags: []command.Flag{
      {
        Name: "test",
      },
    },
  }
}

// ä¿®æ”¹å
func (receiver *VendorPublishCommand) Extend() command.Extend {
  return command.Extend{
    Category: "test",
    Flags: []command.Flag{
      &command.StringFlag{
        Name: "test",
      },
    },
  }
}
```

### 7. 7ã€‚ æ–‡ä»¶ç³»ç»Ÿæ¨¡å—å–æ¶ˆå¯¹ S3ã€OSSã€COSã€Minio çš„é»˜è®¤æ”¯æŒ

ä¸ºäº†å‡å°‘åŠ è½½ä¸å¿…è¦çš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œå‡å°åŒ…ä½“ç§¯ï¼Œæé«˜ç¼–è¯‘æ•ˆç‡ï¼ŒGoravel å°†é€æ­¥å°†å„æ¨¡å—é©±åŠ¨å‰¥ç¦»ä¸ºç‹¬ç«‹çš„æ‰©å±•åŒ…ã€‚ åœ¨æ­¤æ¬¡å‡çº§ä¸­ï¼Œ`Filesystem` æ¨¡å—å–æ¶ˆäº†å¯¹ `S3`ã€`OSS`ã€`COS`ã€`Minio` é©±åŠ¨çš„é»˜è®¤æ”¯æŒï¼Œå¹¶å°†æ”¯æŒè½¬ç§»åˆ°ç‹¬ç«‹çš„æ‰©å±•åŒ…ä¸­ã€‚ In this upgrade, the `Filesystem` module cancels the default support for `S3`, `OSS`, `COS`, `Minio` drivers, and transfers support to independent extension packages.

ç§»é™¤ `config/filesystems.go::disks` ä¸­é™¤ `local` å’Œæ­£åœ¨ä½¿ç”¨çš„é©±åŠ¨ä¹‹å¤–çš„é”®ï¼š

```go
// ä¿®æ”¹å
"disks": map[string]any{
  "local": map[string]any{
    "driver": "local",
    "root":   "storage/app",
    "url":    config.Env("APP_URL", "").(string) + "/storage",
  },
},
```

å¦‚æœæ‚¨ä½¿ç”¨é™¤ `local` ä»¥å¤–çš„å…¶ä»–é©±åŠ¨ç¨‹åºï¼Œè¯·å‚è€ƒç›¸åº”é©±åŠ¨ç¨‹åºçš„æ–‡æ¡£è¿›è¡Œå®‰è£…ï¼š

| é©±åŠ¨ç¨‹åº  | é“¾æ¥                                                                                                   |
| ----- | ---------------------------------------------------------------------------------------------------- |
| S3    | [https://github.com/goravel/s3](https://github.com/goravel/s3)       |
| OSS   | [https://github.com/goravel/oss](https://github.com/goravel/oss)     |
| COS   | [https://github.com/goravel/cos](https://github.com/goravel/cos)     |
| Minio | [https://github.com/goravel/minio](https://github.com/goravel/minio) |

### 8. 8ã€‚ ç¼“å­˜æ¨¡å—å–æ¶ˆé»˜è®¤æ”¯æŒ Redis

å¦‚æœæ‚¨æ²¡æœ‰ä½¿ç”¨ Redisï¼Œè¯·åœ¨ `config/cache.go::stores` ä¸­åˆ é™¤ `redis` é”®ï¼š

```go
// å·²ä¿®æ”¹
"stores": map[string]any{
  "memory": map[string]any{
    "driver": "memory",
  },
},
```

å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ `redis` é©±åŠ¨ï¼Œè¯·å‚è€ƒ `redis` é©±åŠ¨æ–‡æ¡£è¿›è¡Œå®‰è£…ï¼š

| é©±åŠ¨    | é“¾æ¥                                                                                                   |
| ----- | ---------------------------------------------------------------------------------------------------- |
| Redis | [https://github.com/goravel/redis](https://github.com/goravel/redis) |

### 9. 9ã€‚ æ›´æ”¹æ¨¡å‹ä¸­ CreatedAtã€UpdatedAt çš„ç±»å‹ï¼ˆå¦‚æœä½¿ç”¨ï¼‰

ä¸ºäº†ä½¿ API è¾“å‡ºä¸­çš„æ—¶é—´ç±»å‹æ›´åŠ æ ‡å‡†ï¼Œ`Model` ä¸­ `CreatedAt`ã€`UpdatedAt` çš„ç±»å‹ä» `time.Time` æ”¹ä¸º `carbon.DateTime`ã€‚ å¦‚æœæ‚¨å¯¹è¿™ä¸¤ä¸ªå­—æ®µæœ‰é¢å¤–çš„å¤„ç†ï¼Œå¯ä»¥é€šè¿‡ `CreatedAt.ToStdTime()` æ–¹æ³•è·å–åŸå§‹çš„ `time.Time` ç±»å‹ã€‚ ä¸ºäº†ä½¿æ—¶é—´ç±»å‹åœ¨æ¥å£è¾“å‡ºæ—¶æ›´åŠ æ ‡å‡†ï¼Œ`CreatedAt`, `UpdatedAt` ç±»å‹ç”± `time.Time` ä¿®æ”¹ä¸º `carbon.DateTime`ã€‚å¦‚æœæ‚¨å¯¹è¿™ä¸¤ä¸ªå­—æ®µè¿›è¡Œäº†é¢å¤–å¤„ç†ï¼Œå¯ä»¥é€šè¿‡ `CreatedAt.ToStdTime()` æ–¹æ³•è·å–åŸæœ‰çš„ `time.Time` ç±»å‹ã€‚

### 10. 10ã€‚ ä¼˜åŒ–éªŒè¯æ¨¡å—çš„è§„åˆ™ï¼ˆå¦‚æœä½¿ç”¨ï¼‰

æ£€æŸ¥åŸå§‹éªŒè¯è§„åˆ™ä¸­çš„é›¶å€¼ï¼Œä¾‹å¦‚ï¼Œå¦‚æœè§„åˆ™è®¾ç½®ä¸º `date` ä¸”æœªè®¾ç½® `required`ï¼Œè€Œå­—æ®µä¸ºç©ºæˆ–æœªä¼ é€’ï¼ŒéªŒè¯æ¨¡å—å°†æç¤ºè¯¥å­—æ®µæ˜¯å¿…éœ€çš„ã€‚ ä¼˜åŒ–åï¼ŒéªŒè¯æ¨¡å—å°†é€šè¿‡æ£€æŸ¥ï¼Œä½¿ç”¨èµ·æ¥æ›´åŠ ç›´è§‚ã€‚ å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ç›¸å…³éªŒè¯ï¼Œè¯·ç¡®ä¿å‡çº§åç¬¦åˆé¢„æœŸã€‚ After optimization, the validation module will passed the check, which is more intuitive to use. If you are using relevant validation, please ensure that the upgrade is as expected.

### 11ã€‚ é‡æ–°å®‰è£…ä¾èµ– å†æ¬¡å®‰è£…ä¾èµ–

è¿è¡Œ `go mod tidy`

## åŠŸèƒ½ä»‹ç»

### æœåŠ¡å®¹å™¨

ç‰ˆæœ¬ï¼šv1.12.0

Goravel ä¸­çš„æ‰€æœ‰æœåŠ¡éƒ½åœ¨æœåŠ¡å®¹å™¨ä¸­æ³¨å†Œï¼Œä¸ºåŒ…å¼€å‘æä¾›å¼ºå¤§æ”¯æŒï¼Œ[è¯¦æƒ…](../foundation/container)

### åŒ…å¼€å‘

ç‰ˆæœ¬ï¼šv1.12.0

åŒ…æ˜¯å‘ Goravel æ·»åŠ åŠŸèƒ½çš„ä¸»è¦æ–¹å¼ï¼Œå¯ä»¥ä¸°å¯Œ Goravel çš„ç”Ÿæ€ï¼Œ[è¯¦æƒ…](../advanced/package)

### Artisan Flag æ·»åŠ æ–°æ–¹æ³•

ç‰ˆæœ¬ï¼šv1.12.0

ä¸º Artisan æ¨¡å—æ·»åŠ è·å–ä¸åŒç±»å‹ `Flag` çš„æ–¹æ³•ï¼Œ[è¯¦æƒ…](../advanced/artisan#options)

### æ·»åŠ è¾…åŠ©æ–¹æ³•

ç‰ˆæœ¬ï¼šv1.12.0

æ·»åŠ  `path` å’Œ `carbon` è¾…åŠ©æ–¹æ³•ï¼Œæ‚¨å¯ä»¥è½»æ¾è·å–è·¯å¾„ä¿¡æ¯å¹¶åœ¨é¡¹ç›®ä¸­å¤„ç†æ—¶é—´ï¼Œ[è¯¦æƒ…](../advanced/helpers)ã€‚

### å‡çº§ä¾èµ–

ç‰ˆæœ¬ï¼šv1.12.0

ä¸ºäº†æä¾›æ›´å¥½çš„åŠŸèƒ½æ”¯æŒï¼ŒGoravel ä¾èµ–çš„æ‰€æœ‰åŒ…çš„ç‰ˆæœ¬éƒ½å·²å‡çº§ã€‚

### è¿ç§»æ·»åŠ æ–°æ–¹æ³•

ç‰ˆæœ¬ï¼šv1.12.0

| Commands                        | æ“ä½œ             |
| ------------------------------- | -------------- |
| migrate:fresh   | åˆ é™¤æ‰€æœ‰è¡¨å¹¶é‡æ–°è¿è¡Œæ‰€æœ‰è¿ç§» |
| migrate:refresh | é‡ç½®å¹¶é‡æ–°è¿è¡Œæ‰€æœ‰è¿ç§»    |
| migrate:reset   | å›æ»šæ‰€æœ‰æ•°æ®åº“è¿ç§»      |
| migrate:status  | æ˜¾ç¤ºæ¯ä¸ªè¿ç§»çš„çŠ¶æ€      |

### ä¸€äº› `make` å‘½ä»¤æ”¯æŒå­ç›®å½•

ç‰ˆæœ¬ï¼šv1.12.0

| å‘½ä»¤                                                  | ç”Ÿæˆæ–‡ä»¶                                                                              |
| --------------------------------------------------- | --------------------------------------------------------------------------------- |
| make:policy User/AuthPolicy         | app/policies/User/auth_policy.go             |
| make:command Goravel/CleanCache     | app/console/commands/Goravel/clean_cache.go  |
| make:model User/Phone               | app/models/User/phone.go                                          |
| make:observer User/PhoneObserver    | app/observers/User/phone_observer.go         |
| make:event User/GoravelEvent        | app/events/User/goravel_event.go             |
| make:listener User/GoravelListen    | app/listeners/User/goravel_listen.go         |
| make:controller User/AuthController | app/http/controllers/User/auth_controller.go |
| make:middleware User/Auth           | app/http/middleware/User/auth.go                                  |
| make:request User/Auth              | app/http/requests/User/auth.go                                    |
| make:job Goravel/Job                | app/jobs/Goravel/job.go                                           |
| make:rule User/Phone                | app/rules/User/phone.go                                           |

### Windowsä¸‹æ–‡ä»¶è·¯å¾„å¯¼è‡´çš„Panicé—®é¢˜

ç‰ˆæœ¬ï¼šv1.12.1

ä¿®å¤åœ¨ Windows ä¸‹ `make` å‘½ä»¤è‡ªåŠ¨åˆ›å»ºæ–‡ä»¶å¤¹æ—¶ç”±åæ–œæ å¯¼è‡´çš„å´©æºƒé—®é¢˜ã€‚

### facades.Gate() è¿”å› nil çš„é—®é¢˜

ç‰ˆæœ¬ï¼šv1.12.2

ä¿®å¤ `facades.Gate()` è¿”å› nil çš„é—®é¢˜ã€‚

### Windows ä¸‹ make:package å‘½ä»¤çš„é—®é¢˜

ç‰ˆæœ¬ï¼šv1.12.3

åœ¨ Windows ä¸‹ `make:package` å‘½ä»¤åˆ›å»ºçš„æ–‡ä»¶è·¯å¾„é”™è¯¯ã€‚

### throttle ä¸­é—´ä»¶ panic çš„é—®é¢˜

ç‰ˆæœ¬ï¼šv1.12.4

ä¿®å¤ throttle ä¸­é—´ä»¶ panic çš„é—®é¢˜ã€‚

### ä¿®å¤ facades.Orm().Query().Load() çš„é—®é¢˜

ç‰ˆæœ¬ï¼šv1.12.5

ä¿®å¤åœ¨æŸäº›æƒ…å†µä¸‹ `facades.Orm().Query().Load()` æ— æ³•æ­£ç¡®åŠ è½½æ¨¡å‹çš„é—®é¢˜ã€‚

### ä¿®å¤ JWT é—®é¢˜

ç‰ˆæœ¬ï¼šv1.12.6

ä¿®å¤å½“ JWT Token è¿‡æœŸä¸”æ— æ•ˆæ—¶ï¼Œè¿”å›è¿‡æœŸé”™è¯¯ï¼Œè€Œé¢„æœŸåº”å…ˆè¿”å›æ— æ•ˆé”™è¯¯çš„é—®é¢˜ã€‚
