# ä» v1.16 å‡çº§åˆ° v1.17

## ä»¤äººå…´å¥‹çš„æ–°åŠŸèƒ½ ğŸ‰

- [Goravel Lite](#goravel-lite)
- [ç®€åŒ–çš„ä»£ç ç»“æ„](#simplified-code-structure)
- [Process Facade](#process-facade)
- [å¤æ•°åŒ–åŒ…](#pluralizer-package)
- [æœåŠ¡æä¾›è€…è¿è¡Œå™¨](#service-provider-runners)

## åŠŸèƒ½å¢å¼º ğŸš€

- [facades å¯æŒ‰éœ€å®‰è£…å’Œå¸è½½](#facades-can-be-installed-and-uninstalled-as-needed)
- [é‚®ä»¶å¯é€šè¿‡æ¨¡æ¿å‘é€](#mail-can-be-sent-via-template)
- [build å‘½ä»¤æ”¯æŒæ›´å¤šæ ‡å¿—](#the-build-command-supports-more-flags)
- [ä¸º DB å’Œ Orm æ·»åŠ å’Œä¿®æ”¹å‡½æ•°](#add-and-modify-functions-for-db-and-orm)
- [ä¸º Schema æ·»åŠ æ–°å‡½æ•°](#add-new-functions-for-schema)
- [æ·»åŠ æ–°å‘½ä»¤](#add-new-commands)
- [æ·»åŠ  csrf ä»¤ç‰Œä¸­é—´ä»¶](#add-csrf-token-middleware)
- [å‘½ä»¤æ”¯æŒé…ç½®å‚æ•°](#command-supports-configure-arguments)
- [make:migration æ”¯æŒé€šè¿‡æ¨¡å‹åˆ›å»ºè¿ç§»](#make-migration-supports-create-migration-via-model)
- [ä¼˜åŒ– gRPC å®¢æˆ·ç«¯è¿æ¥](#optimize-grpc-connections)
- [æ—¥å¿—æ”¯æŒæ‰“å° json æ ¼å¼](#log-supports-print-json-format)
- [Http æ”¯æŒå¤šä¸ªå®¢æˆ·ç«¯](#http-supports-multiple-clients)
- [éªŒè¯æ”¯æŒä¼ é€’ä¸Šä¸‹æ–‡](#validation-supports-pass-context)
- [ä¸º Orm æ·»åŠ  WithoutGlobalScopes å‡½æ•°](#add-withoutglobalscopes-function-for-orm)

## ç ´åæ€§å˜åŒ– ğŸ› 

- [ç§»é™¤ machinery é˜Ÿåˆ—é©±åŠ¨](#remove-machinery-queue-driver)
- [ä¿®æ”¹ grpc é…ç½®](#modify-grpc-configuration)
- [åˆ‡æ¢æ—¥å¿—é©±åŠ¨](#switch-log-driver)
- [ä¼˜åŒ– migrate:rollback å‘½ä»¤](#optimize-migrate-rollback-command)
- [ç§»é™¤ Http.Request.Bind å‡½æ•°](#remove-http-request-bind-function)

## å‡çº§æŒ‡å—

éšç€ [Golang v1.23 ä¸å†è¢«ç»´æŠ¤](https://endoflife.date/go)ï¼ŒGoravel æ”¯æŒçš„ Golang ç‰ˆæœ¬å·²ä» 1.23 å‡çº§åˆ° 1.24ã€‚

goravel/example é¡¹ç›®ä» v1.16 å‡çº§åˆ° v1.17 çš„ PR å¯ä½œä¸ºå‡çº§å‚è€ƒï¼š[goravel/example#93](https://github.com/goravel/example/pull/93)ã€‚

### 1. æ›´æ–°ä¾èµ–

```shell
go get github.com/goravel/framework@latest

// å¦‚æœä½¿ç”¨ gin
go get github.com/goravel/gin@latest

// å¦‚æœä½¿ç”¨ fiber
go get github.com/goravel/fiber@latest

// å¦‚æœä½¿ç”¨ redis
go get github.com/goravel/redis@latest

// å¦‚æœä½¿ç”¨ S3
go get github.com/goravel/s3@latest

// å¦‚æœä½¿ç”¨ Oss
go get github.com/goravel/oss@latest

// å¦‚æœä½¿ç”¨ Cos
go get github.com/goravel/cos@latest

// å¦‚æœä½¿ç”¨ Minio
go get github.com/goravel/minio@latest

go mod tidy
```

### 2. æ·»åŠ æ–°çš„æœåŠ¡æä¾›è€…

```go
// config/app.go
import (
  ...
  "github.com/goravel/framework/facades/process"
  "github.com/goravel/framework/facades/view"
)

"providers": []foundation.ServiceProvider{
  ...
  &process.ServiceProvider{}, // [!code ++]
  &view.ServiceProvider{}, // [!code ++]
},
```

### 3. ä¿®æ”¹ http å®¢æˆ·ç«¯é…ç½®

åœ¨ `config/http.go` ä¸­æ·»åŠ æ–°é…ç½®ï¼š

```go
"client": map[string]any{ // [!code --]
  "base_url":                config.GetString("HTTP_CLIENT_BASE_URL"), // [!code --]
  "timeout":                 config.GetDuration("HTTP_CLIENT_TIMEOUT"), // [!code --]
  "max_idle_conns":          config.GetInt("HTTP_CLIENT_MAX_IDLE_CONNS"), // [!code --]
  "max_idle_conns_per_host": config.GetInt("HTTP_CLIENT_MAX_IDLE_CONNS_PER_HOST"), // [!code --]
  "max_conns_per_host":      config.GetInt("HTTP_CLIENT_MAX_CONN_PER_HOST"), // [!code --]
  "idle_conn_timeout":       config.GetDuration("HTTP_CLIENT_IDLE_CONN_TIMEOUT"), // [!code --]
}, // [!code --]
"default_client": config.Env("HTTP_CLIENT_DEFAULT", "default"), // [!code ++]
"clients": map[string]any{ // [!code ++]
  "default": map[string]any{ // [!code ++]
    "base_url": config.Env("HTTP_CLIENT_BASE_URL", ""), // [!code ++]
    "timeout": config.Env("HTTP_CLIENT_TIMEOUT", "30s"), // [!code ++]
    "max_idle_conns": config.Env("HTTP_CLIENT_MAX_IDLE_CONNS", 100), // [!code ++]
    "max_idle_conns_per_host": config.Env("HTTP_CLIENT_MAX_IDLE_CONNS_PER_HOST", 2), // [!code ++]
    "max_conns_per_host": config.Env("HTTP_CLIENT_MAX_CONN_PER_HOST", 0), // [!code ++]
    "idle_conn_timeout": config.Env("HTTP_CLIENT_IDLE_CONN_TIMEOUT", "90s"), // [!code ++]
  }, // [!code ++]
}, // [!code ++]
```

### 4. ä¿®æ”¹ grpc é…ç½®

éœ€ç›¸åº”ä¿®æ”¹ï¼š[ä¿®æ”¹ grpc é…ç½®](#modify-grpc-configuration)

### 5. å¦‚æœæƒ³é€šè¿‡æ¨¡æ¿å‘é€é‚®ä»¶

åœ¨ `config/mail.go` ä¸­æ·»åŠ æ–°é…ç½®ï¼š

```go
// æ¨¡æ¿é…ç½®
//
// è¿™æ§åˆ¶é‚®ä»¶è§†å›¾çš„æ¨¡æ¿æ¸²æŸ“ã€‚æ¨¡æ¿å¼•æ“å…¨å±€ç¼“å­˜ï¼Œ
// å¹¶æ”¯æŒå†…ç½®é©±åŠ¨å’Œé€šè¿‡å·¥å‚çš„è‡ªå®šä¹‰å®ç°ã€‚
//
// å¯ç”¨é©±åŠ¨ï¼š"html"ã€"custom"
"template": map[string]any{
  "default": config.Env("MAIL_TEMPLATE_ENGINE", "html"),
  "engines": map[string]any{
    "html": map[string]any{
      "driver": "html",
      "path":   config.Env("MAIL_VIEWS_PATH", "resources/views/mail"),
    },
  },
},
```

### 6. å¦‚æœæ­£åœ¨ä½¿ç”¨ machinery é˜Ÿåˆ—é©±åŠ¨

éœ€ç›¸åº”ä¿®æ”¹ï¼š[ç§»é™¤ machinery é˜Ÿåˆ—é©±åŠ¨](#remove-machinery-queue-driver)

### 7. å¦‚æœåˆ›å»ºäº†è‡ªå®šä¹‰æ—¥å¿—é©±åŠ¨

éœ€ç›¸åº”ä¿®æ”¹ï¼š[åˆ‡æ¢æ—¥å¿—é©±åŠ¨](#switch-log-driver)

### 8. å¦‚æœæ­£åœ¨ä½¿ç”¨ Http.Request.Bind å‡½æ•°

éœ€ç›¸åº”ä¿®æ”¹ï¼š[ç§»é™¤ Http.Request.Bind å‡½æ•°](#remove-http-request-bind-function)

### 9. å¦‚æœæ­£åœ¨ä½¿ç”¨ validation.Make å‡½æ•°æˆ–è‡ªå®šä¹‰è§„åˆ™/è¿‡æ»¤å™¨

éœ€ç›¸åº”ä¿®æ”¹ï¼š[éªŒè¯æ”¯æŒä¼ é€’ä¸Šä¸‹æ–‡](#validation-supports-pass-context)

### 10. å¦‚æœæ­£åœ¨ä½¿ç”¨ Orm ä¸­çš„å…¨å±€ä½œç”¨åŸŸ

éœ€ç›¸åº”ä¿®æ”¹ï¼š[ä¸º Orm æ·»åŠ  WithoutGlobalScopes å‡½æ•°](#add-withoutglobalscopes-function-for-orm)

## åŠŸèƒ½ä»‹ç»

### Goravel Lite

æˆ‘ä»¬å¾ˆé«˜å…´æ¨å‡º [Goravel Lite](https://github.com/goravel/goravel-lite)ï¼Œè¿™æ˜¯ Goravel æ¡†æ¶çš„è½»é‡çº§ç‰ˆæœ¬ï¼Œä¸“ä¸ºå¸Œæœ›ä»¥æœ€å°ä¾èµ–å’Œæ›´å°å ç”¨ç©ºé—´æ„å»ºåº”ç”¨ç¨‹åºçš„å¼€å‘è€…è®¾è®¡ã€‚ å®ƒæä¾›äº† Goravel çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒæ—¶å…è®¸å¼€å‘è€…ä»…æ·»åŠ ä»–ä»¬éœ€è¦çš„ç»„ä»¶ã€‚

- ä»…åŒ…å«å¿…è¦çš„ facadesï¼š`Artisan`ã€`Config`ï¼Œå‡å°‘è‡ƒè‚¿å¹¶æé«˜æ€§èƒ½ã€‚
- å…¶ä»– facades å¯é€šè¿‡ `package:install` å’Œ `package:uninstall` å‘½ä»¤æŒ‰éœ€å®‰è£…å’Œå¸è½½ã€‚
- `goravel/goravel` == `goravel/goravel-lite` + æ‰€æœ‰ facadesã€‚ å¯¹ `goravel/goravel` çš„ä»»ä½•æ”¹è¿›éƒ½åº”æäº¤åˆ° `goravel/goravel-lite`ï¼Œç„¶åæŒ‡å®šçš„ GitHub Action ä¼šå°†æ›´æ”¹åŒæ­¥åˆ° `goravel/goravel`ã€‚ å¹¶ä¸” `goravel/goravel` ä»ç„¶æ˜¯ç”¨æˆ·ä½¿ç”¨ Goravel æ¡†æ¶çš„ä¸»è¦ä»“åº“ã€‚
- `goravel/installer` å°†ä½¿ç”¨ `goravel/goravel-lite` ä½œä¸ºé»˜è®¤æ¡†æ¶æ¥åˆ›å»ºæ–°çš„ Goravel é¡¹ç›®ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©å®‰è£…æ‰€éœ€çš„å¤–è§‚ã€‚

### ç®€åŒ–çš„ä»£ç ç»“æ„

ä»£ç ç»“æ„å·²ç®€åŒ–ï¼Œä»¥æé«˜å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§ï¼Œå¹¶ä¸ Laravel ä¿æŒä¸€è‡´ã€‚ æ—§ç»“æ„ä»å¯ä½¿ç”¨ï¼Œè¿™æ˜¯ä¸€ä¸ªå‘åå…¼å®¹çš„æ›´æ”¹ã€‚ ä»æ—§ç»“æ„è¿ç§»åˆ°æ–°ç»“æ„æœ‰ç‚¹å¤æ‚ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥å‚è€ƒç¤ºä¾‹ PRï¼š[goravel/example#91](https://github.com/goravel/example/pull/91)ã€‚

1. åˆ é™¤æ‰€æœ‰ `kenel.go` å’Œé»˜è®¤çš„ `*_service_providers.go` æ–‡ä»¶ã€‚ å°† `*_service_providers.go` æ–‡ä»¶ä¸­çš„é…ç½®ç§»åŠ¨åˆ° `bootstrap` æ–‡ä»¶å¤¹ã€‚
2. å°†æ‰€æœ‰å¤–è§‚ä»æ¡†æ¶å†…éƒ¨ç§»åŠ¨åˆ° `app/facades` æ–‡ä»¶å¤¹ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦è‡ªå®šä¹‰æˆ–æ‰©å±•å®ƒä»¬ã€‚
3. ç®€åŒ–å¤–è§‚å¯åŠ¨è¿‡ç¨‹ï¼Œä¸å†éœ€è¦åœ¨ `main.go` ä¸­è¿è¡Œå¤–è§‚ï¼Œæ›´å¤šè¯¦æƒ…è¯·å‚é˜… [æœåŠ¡æä¾›è€…è¿è¡Œå™¨](../architecture-concepts/service-providers.md#runners)ã€‚
4. æ”¯æŒé€šè¿‡ `WithPath()` å‡½æ•°è‡ªå®šä¹‰ç›®å½•ç»“æ„ï¼Œæ›´å¤šè¯¦æƒ…è¯·å‚é˜… [è‡ªå®šä¹‰ç›®å½•ç»“æ„](../getting-started/directory-structure.md#customize-directory-structure)ã€‚

### è¿›ç¨‹å¤–è§‚

Goravel ç°åœ¨å›´ç»• Go æ ‡å‡† `os/exec` åŒ…æä¾›äº†ä¸€ä¸ªå¯Œæœ‰è¡¨ç°åŠ›ä¸”ä¼˜é›…çš„ APIï¼Œå…è®¸ä½ ä»åº”ç”¨ç¨‹åºä¸­æ— ç¼è°ƒç”¨å¤–éƒ¨å‘½ä»¤ã€‚

è¯¦æƒ…è¯· [æŸ¥çœ‹æ–‡æ¡£](../digging-deeper/processes.md)

### å¤æ•°åŒ–åŒ…

Goravel ç°åœ¨åŒ…å«ä¸€ä¸ªå¤æ•°åŒ–åŒ…ï¼Œå¯æ ¹æ®è¯­è¨€è§„åˆ™å¸®åŠ©åœ¨å•è¯çš„å•æ•°å’Œå¤æ•°å½¢å¼ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚ è¿™å¯¹äºéœ€è¦å¤„ç†ä¸åŒè¯­è¨€åŠå…¶è¯­æ³•è§„åˆ™çš„åº”ç”¨ç¨‹åºéå¸¸æœ‰ç”¨ã€‚

è¯¦æƒ…è¯· [æŸ¥çœ‹æ–‡æ¡£](../digging-deeper/pluralization.md)

### æœåŠ¡æä¾›è€…è¿è¡Œå™¨

æœåŠ¡æä¾›è€…ç°åœ¨å¯ä»¥å®ç° `Runners` æ¥å£ï¼Œåœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶è¿è¡Œä»£ç ã€‚ è¿™é€šå¸¸ç”¨äºå¯åŠ¨æˆ–å…³é—­æœåŠ¡æä¾›è€…ä¸­å®šä¹‰çš„æœåŠ¡ï¼Œä¾‹å¦‚è·¯ç”±ã€è°ƒåº¦ã€é˜Ÿåˆ—ç­‰ã€‚ ä½ ä¸å†éœ€è¦åœ¨ `main.go` ä¸­æ‰‹åŠ¨å¯åŠ¨æˆ–å…³é—­è¿™äº›æœåŠ¡ï¼Œå› ä¸º Goravel ä¼šä¸ºä½ å¤„ç†ã€‚

æ­¤åŠŸèƒ½ä»…åœ¨ä½¿ç”¨ [æ–°çš„ç®€åŒ–ä»£ç ç»“æ„](#simplified-code-structure) æ—¶å¯ç”¨ã€‚

[æŸ¥çœ‹æ–‡æ¡£](../architecture-concepts/service-providers.md#runners)

### æ—¥å¿—æ”¯æŒæ‰“å° JSON æ ¼å¼

Goravel çš„æ—¥å¿—ç³»ç»Ÿç°åœ¨æ”¯æŒä»¥ JSON æ ¼å¼è¾“å‡ºæ—¥å¿—ï¼Œä½¿å…¶æ›´å®¹æ˜“ä¸æ—¥å¿—ç®¡ç†ç³»ç»Ÿé›†æˆå¹¶æ‰§è¡Œç»“æ„åŒ–æ—¥å¿—è®°å½•ã€‚

```go
"channels": map[string]any{
  "daily": map[string]any{
    "driver":    "daily",
    "path":      "storage/logs/goravel.log",
    "level":     config.Env("LOG_LEVEL", "debug"),
    "days":      7,
    "print":     true,
    // å€¼å¯ä»¥æ˜¯ "text" æˆ– "json"
    "formatter": "json", // [!code ++]
  },
},
```

### HTTP æ”¯æŒå¤šä¸ªå®¢æˆ·ç«¯

Goravel çš„ HTTP å®¢æˆ·ç«¯æ¨¡å—ç°åœ¨æ”¯æŒå¤šä¸ªå®¢æˆ·ç«¯ï¼Œå…è®¸ä½ å®šä¹‰å’Œä½¿ç”¨å…·æœ‰å„è‡ªé…ç½®çš„ä¸åŒ HTTP å®¢æˆ·ç«¯ï¼Œä»¥æ»¡è¶³åº”ç”¨ç¨‹åºå†…çš„å„ç§ç”¨é€”ã€‚

[æŸ¥çœ‹æ–‡æ¡£](../digging-deeper/http-client.md#making-requests)

### éªŒè¯æ”¯æŒä¼ é€’ä¸Šä¸‹æ–‡

Goravel çš„éªŒè¯æ¨¡å—ç°åœ¨æ”¯æŒå°†ä¸Šä¸‹æ–‡ä¼ é€’ç»™éªŒè¯å‡½æ•°ï¼Œä»è€Œèƒ½å¤ŸåŸºäºè¯·æ±‚æˆ–æ“ä½œçš„ä¸Šä¸‹æ–‡å®ç°æ›´çµæ´»å’ŒåŠ¨æ€çš„éªŒè¯åœºæ™¯ã€‚

```go
validator, err := facades.Validation().Make(input, rules) // [!code --]
validator, err := facades.Validation().Make(ctx, input, rules) // [!code ++]
```

è‡ªå®šä¹‰è§„åˆ™å’Œè¿‡æ»¤å™¨ä¹Ÿæ”¯æŒä¸Šä¸‹æ–‡å‚æ•°ï¼š

```go
type Rule interface {
  Signature() string
  Passes(data Data, val any, options ...any) bool // [!code --]
  Message() string // [!code --]
  Passes(ctx context.Context, data Data, val any, options ...any) bool // [!code ++]
  Message(ctx context.Context) string // [!code ++]
}

type Filter interface {
  Signature() string
  Handle() any // [!code --]
  Handle(ctx context.Context) any // [!code ++]
}
```

### ä¸º Orm æ·»åŠ  WithoutGlobalScopes å‡½æ•°

Orm åŒ…æ–°å¢äº†ä¸€ä¸ª `WithoutGlobalScopes` å‡½æ•°ï¼Œå…è®¸ä½ ä»æŸ¥è¯¢ä¸­æ’é™¤æ‰€æœ‰å…¨å±€ä½œç”¨åŸŸã€‚ å½“ä½ æƒ³æ£€ç´¢ä¸å—å…¨å±€ä½œç”¨åŸŸçº¦æŸçš„è®°å½•æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ã€‚

```go
var user []User
err := facades.Orm().Model(&User{}).WithoutGlobalScopes().Get(&user)
err := facades.Orm().Model(&User{}).WithoutGlobalScopes("name").Get(&user)
```

ä¸ºäº†æ”¯æŒè®¾ç½®å…¨å±€ä½œç”¨åŸŸåç§°ï¼Œæ¨¡å‹çš„ `GlobalScope` æ¥å£å·²è¢«ä¿®æ”¹ï¼š

```go
import "github.com/goravel/framework/contracts/orm"

type User struct {
  orm.Model
  Name string
}

func (r *User) GlobalScopes() []func(orm.Query) orm.Query { // [!code --]
func (r *User) GlobalScopes() map[string]func(orm.Query) orm.Query { // [!code ++]
  return map[string]func(orm.Query) orm.Query{
    "name": func(query orm.Query) orm.Query {
      return query.Where("name", "goravel")
    },
  }
}
```

### å¤–è§‚å¯ä»¥æ ¹æ®éœ€è¦å®‰è£…å’Œå¸è½½

éšç€ [Goravel Lite](#goravel-lite) çš„å‘å¸ƒï¼Œç°åœ¨å¯ä»¥é€šè¿‡ `package:install` å’Œ `package:uninstall` å‘½ä»¤æ ¹æ®éœ€è¦å®‰è£…å’Œå¸è½½å¤–è§‚ã€‚ æ³¨æ„ï¼šæ­¤åŠŸèƒ½ä»…åœ¨ä½ çš„é¡¹ç›®ä½¿ç”¨ Goravel Lite æ„å»ºæˆ–å‡çº§åˆ° [æ–°çš„ç®€åŒ–ä»£ç ç»“æ„](#simplified-code-structure) æ—¶å¯ç”¨ã€‚

[æŸ¥çœ‹æ–‡æ¡£](../architecture-concepts/facades.md#install-uninstall-facades)

### é‚®ä»¶å¯ä»¥é€šè¿‡æ¨¡æ¿å‘é€

é‚®ä»¶å‘é€ç°åœ¨æ”¯æŒæ¨¡æ¿ï¼Œå…è®¸ä½ ä½¿ç”¨é¢„å®šä¹‰çš„æ¨¡æ¿å‘é€ç”µå­é‚®ä»¶ï¼Œä»¥è·å¾—æ›´å¥½çš„ä¸€è‡´æ€§å’Œæ›´è½»æ¾çš„ç®¡ç†ã€‚ æ¨¡æ¿æ”¯æŒ HTTP å’Œè‡ªå®šä¹‰é©±åŠ¨ã€‚

è¯¦æƒ…è¯· [æŸ¥çœ‹æ–‡æ¡£](../digging-deeper/mail.md#using-template)

### build å‘½ä»¤æ”¯æŒæ›´å¤šæ ‡å¿—

å‘ `build` å‘½ä»¤æ·»åŠ æ–°çš„ `--arch` å’Œ `--static` æ ‡å¿—ï¼Œå…è®¸ä½ æŒ‡å®šç›®æ ‡æ¶æ„ä»¥åŠæ˜¯å¦æ„å»ºé™æ€äºŒè¿›åˆ¶æ–‡ä»¶ã€‚

### ä¸º DB å’Œ Orm æ·»åŠ å’Œä¿®æ”¹å‡½æ•°

æ–°å‡½æ•°ï¼š

- `Avg(column string, dest any) error`ï¼šè®¡ç®—åˆ—çš„å¹³å‡å€¼ã€‚
- `Min(column string, dest any) error`ï¼šæŸ¥æ‰¾åˆ—çš„æœ€å°å€¼ã€‚
- `Max(column string, dest any) error`ï¼šæŸ¥æ‰¾åˆ—çš„æœ€å¤§å€¼ã€‚
- `WhereAll(columns []string, args ...any) Query`ï¼šå‘æŸ¥è¯¢æ·»åŠ â€œæ‰€æœ‰åˆ—åŒ¹é…â€å­å¥ã€‚
- `WhereAny(columns []string, args ...any) Query`ï¼šå‘æŸ¥è¯¢æ·»åŠ â€œä»»æ„åˆ—åŒ¹é…â€å­å¥ã€‚
- `WhereNone(columns []string, args ...any) Query`ï¼šå‘æŸ¥è¯¢æ·»åŠ â€œæ²¡æœ‰åˆ—åŒ¹é…â€å­å¥ã€‚

ä¿®æ”¹çš„å‡½æ•°ï¼š

```go
// ä¹‹å‰
Sum(column string) (int64, error)

// ä¹‹å
Sum(column string, dest any) error
```

### ä¸º Schema æ·»åŠ æ–°å‡½æ•°

å·²å‘ Schema åŒ…æ·»åŠ æ–°å‡½æ•°ï¼Œä»¥å¢å¼ºæ•°æ®åº“æ¨¡å¼ç®¡ç†èƒ½åŠ›ã€‚

- `DateTimes`ï¼šåœ¨è¡¨ä¸Šåˆ›å»º `created_at` å’Œ `updated_at` åˆ—ã€‚
- `ForeignID`ï¼šä¸ºå¤–é”®åˆ›å»ºä¸€ä¸ªæ— ç¬¦å·å¤§æ•´æ•°åˆ—ã€‚
- `ForeignUlid`ï¼šä¸ºå¤–é”®åˆ›å»ºä¸€ä¸ª ULID åˆ—ã€‚
- `ForeignUuid`ï¼šä¸ºå¤–é”®åˆ›å»ºä¸€ä¸ª UUID åˆ—ã€‚

### æ·»åŠ æ–°å‘½ä»¤

- `make:provider`ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æœåŠ¡æä¾›è€…ç±»ã€‚
- `make:view`ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è§†å›¾æ¨¡æ¿æ–‡ä»¶ã€‚

### æ·»åŠ  CSRF ä»¤ç‰Œä¸­é—´ä»¶

å·²æ·»åŠ ä¸€ä¸ªæ–°çš„ä¸­é—´ä»¶ï¼Œä»¥é˜²æ­¢è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰æ”»å‡»ã€‚ æ­¤ä¸­é—´ä»¶å¯åº”ç”¨äºè·¯ç”±ï¼Œä»¥ç¡®ä¿è¯·æ±‚æ¥è‡ªç»è¿‡èº«ä»½éªŒè¯çš„æ¥æºã€‚

[æŸ¥çœ‹æ–‡æ¡£](../the-basics/views.md#csrf-token-middleware)

### å‘½ä»¤æ”¯æŒé…ç½®å‚æ•°

å‘½ä»¤ç°åœ¨æ”¯æŒé…ç½®å‚æ•°ï¼Œå…è®¸ä½ åœ¨è‡ªå®šä¹‰å‘½ä»¤ä¸­æ›´æœ‰æ•ˆåœ°å®šä¹‰å’Œå¤„ç†å‘½ä»¤è¡Œå‚æ•°ã€‚

è¯¦æƒ…è¯· [æŸ¥çœ‹æ–‡æ¡£](../digging-deeper/artisan-console.md#arguments)

### make:migration æ”¯æŒé€šè¿‡æ¨¡å‹åˆ›å»ºè¿ç§»

`make:migration` å‘½ä»¤å·²å¢å¼ºï¼Œæ”¯æŒåŸºäºç°æœ‰æ¨¡å‹åˆ›å»ºè¿ç§»ã€‚ è¿™å…è®¸é€šè¿‡åˆ©ç”¨æ¨¡å‹ä¸­å®šä¹‰çš„ç»“æ„æ¥æ›´å¿«åœ°åˆ›å»ºè¿ç§»ã€‚

[æŸ¥çœ‹æ–‡æ¡£](../database/migrations.md#create-migrations)

### ä¼˜åŒ– gRPC å®¢æˆ·ç«¯è¿æ¥

å·²ä¸º gRPC å®¢æˆ·ç«¯å®ç°å®¢æˆ·ç«¯è¿æ¥æ± ï¼Œä»¥ä¼˜åŒ–æ€§èƒ½å’Œèµ„æºåˆ©ç”¨ç‡ã€‚ è¿™å…è®¸å¤ç”¨ç°æœ‰è¿æ¥ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºæ–°è¿æ¥ï¼Œä»è€Œå‡å°‘å»¶è¿Ÿå¹¶æé«˜æ•ˆç‡ã€‚

### ç§»é™¤ machinery é˜Ÿåˆ—é©±åŠ¨

é‰´äºåœ¨ v1.16 ä¸­å·²å¼ƒç”¨ï¼Œmachinery é˜Ÿåˆ—é©±åŠ¨å·²è¢«å®Œå…¨ç§»é™¤ã€‚ å¦‚æœæ‚¨ä»åœ¨ä½¿ç”¨å®ƒï¼Œè¯·éµå¾ª [v1.16 å‡çº§æ–‡æ¡£](./v1.16.md#optimize-queue-module-configuration) ä¸­çš„æŒ‡å—è¿ç§»åˆ°å…¶ä»–é˜Ÿåˆ—é©±åŠ¨ã€‚

### ä¿®æ”¹ gRPC é…ç½®

gRPC é…ç½® `grpc.clients` å·²ä¿®æ”¹ä¸º `grpc.servers`ï¼Œå¹¶ä¸” `facades.Grpc().Client()` å‡½æ•°å·²è¢«å¼ƒç”¨ï¼Œå°†åœ¨ v1.18 ä¸­ç§»é™¤ï¼Œè¯·æ”¹ç”¨ `facades.Grpc().Connect()` å‡½æ•°ã€‚

```go
// config/grpc.go
"clients": map[string]any{ // [!code --]
"servers": map[string]any{ // [!code ++]
```

```go
facades.Grpc().Client(ctx, "name") // [!code --]
facades.Grpc().Connect("name") // [!code ++]
```

### åˆ‡æ¢æ—¥å¿—é©±åŠ¨

æ—¥å¿—é©±åŠ¨å·²ä» `logrus` åˆ‡æ¢åˆ° `log/slog`ï¼Œä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½å’Œç»“æ„åŒ–æ—¥å¿—è®°å½•èƒ½åŠ›ã€‚

è‡ªå®šä¹‰æ—¥å¿—é©±åŠ¨æ¥å£å·²ä¿®æ”¹ï¼š

```go
// framework/contracts/log/Logger
package log

type Logger interface {
  // Handle pass channel config path here
  Handle(channel string) (Hook, error) // [!code --]
  Handle(channel string) (Handler, error) // [!code ++]
}
```

æ‚¨å¯ä»¥ä½¿ç”¨ `log.HookToHandler` å‡½æ•°æ¥é€‚é…æ—§çš„è‡ªå®šä¹‰æ—¥å¿—é©±åŠ¨ï¼š

```go
type CustomLogger struct {}

func (logger *CustomLogger) Handle(channel string) (log.Handler, error) {
  hook := /* æ‚¨çš„æ—§è‡ªå®šä¹‰æ—¥å¿—é©±åŠ¨é€»è¾‘ */
  
  return log.HookToHandler(hook), nil
}
```

### ä¼˜åŒ– migrate:rollback å‘½ä»¤

ä¹‹å‰ï¼Œ`migrate:rollback` å‘½ä»¤ä¸€æ¬¡åªå›æ»šä¸€ä¸ªè¿ç§»ï¼Œè¿™ä¸ Laravel çš„è¡Œä¸ºä¸ä¸€è‡´ã€‚ ç°åœ¨è¯¥å‘½ä»¤é»˜è®¤å°†å›æ»šæœ€åä¸€æ‰¹çš„æ‰€æœ‰è¿ç§»ã€‚ æ‚¨ä»ç„¶å¯ä»¥ä½¿ç”¨ `--step` é€‰é¡¹æ¥æŒ‡å®šè¦å›æ»šçš„æ‰¹æ¬¡æ•°ã€‚

### ç§»é™¤ Http.Request.Bind å‡½æ•°

`Http.Request` æ¥å£ä¸Šçš„ `Bind` å‡½æ•°å·²è¢«ç§»é™¤ã€‚ æ‚¨ç°åœ¨å¯ä»¥é€šè¿‡ `response` ä½¿ç”¨ `Bind` æ–¹æ³•ã€‚

```go
var user User
response, err := facades.Http().Bind(&user).Get("https://github.com") // [!code --]
response, err := facades.Http().Get("https://github.com") // [!code ++]
err = response.Bind(&user) // [!code ++]
```
