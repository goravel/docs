# ä» v1.14 å‡çº§åˆ° v1.15

## ä»¤äººå…´å¥‹çš„æ–°åŠŸèƒ½ ğŸ‰

- [è¿ç§»æ”¯æŒä½¿ç”¨ Go è¯­è¨€è¿ç§»](#migration-supports-using-go-language-migration)
- [æµ‹è¯•æ”¯æŒ HTTP æµ‹è¯•](#testing-supports-http-testing)

## å¢å¼ºåŠŸèƒ½ ğŸš€

- [HTTP æ”¯æŒè¿”å› Stream](#http-supports-return-stream)
- [HTTP æ”¯æŒè®¾ç½®è¶…æ—¶](#http-supports-setting-timeout)
- [HTTP æ”¯æŒè®¾ç½®è‡ªå®šä¹‰æ¢å¤æ–¹æ³•](#http-supports-setting-custom-recovery-method)
- [Request æ”¯æŒé…ç½® Filter](#request-supports-configure-filter)
- [Request æ·»åŠ  BindQuery æ–¹æ³•](#request-adds-the-bindquery-method)
- [éªŒè¯æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼è§„åˆ™](#validation-supports-regex-rules)
- [è°ƒåº¦æ”¯æŒæ§åˆ¶æ—¥å¿—è¾“å‡º](#schedule-supports-control-log-output)
- [è°ƒåº¦æ·»åŠ äº†Shutdownæ–¹æ³•](#schedule-adds-the-shutdown-method)
- [é‚®ä»¶æ”¯æŒMailableæ¨¡æ¿](#mail-supports-mailable-template)
- [é”™è¯¯æ—¥å¿—è¾“å‡ºä¸­çš„è·Ÿè¸ªæ”¯æŒè·³è½¬](#the-trace-in-error-log-output-supports-jumping)
- [æ—¥å¿—æ”¯æŒæ‰“å°Contextä¸­çš„é”®å€¼å¯¹](#log-supports-printing-key-value-pairs-in-context)
- [æ”¯æŒç›´æ¥è®¾ç½®DSNè¿æ¥æ•°æ®åº“](#support-directly-setting-dsn-to-connect-to-the-database)
- [Ormçš„Createæ–¹æ³•æ”¯æŒä½¿ç”¨mapåˆ›å»º](#the-create-method-of-orm-supports-using-map-to-create)
- [Ormæ·»åŠ é…ç½®é¡¹](#orm-adds-configuration-items)
- [Orm æ·»åŠ  Restore æ–¹æ³•](#orm-adds-restore-method)
- [Orm çš„ Log é›†æˆ Log æ¨¡å—](#orm-s-log-integrated-log-module)
- [Postgres å’Œ Sqlserver é©±åŠ¨æ”¯æŒ Schema](#postgres-and-sqlserver-drivers-support-schema)
- [æ·»åŠ  about å‘½ä»¤](#add-about-command)
- [æ·»åŠ  db:show å‘½ä»¤](#add-db-show-command)
- [æ·»åŠ  db:table å‘½ä»¤](#add-db-table-command)
- [ä¼˜åŒ– Artisan è¾“å‡ºæ ·å¼](#optimize-artisan-output-style)
- [Auth æ·»åŠ  Id æ–¹æ³•](#auth-adds-the-id-method)
- [å¤šä¸ª Auth.Guard å¯ä»¥è®¾ç½®è‡ªå·±çš„ TTL](#multiple-auth-guard-can-set-their-own-ttl)

## ç ´åæ€§å˜æ›´ ğŸ› 

- [PostgreSQL é©±åŠ¨ç¨‹åºåç§°æ›´æ”¹ä¸º Postgres](#the-name-of-postgresql-driver-changes-to-postgres)
- [ä¿®æ”¹ Orm.Transaction æ–¹æ³•å›è°ƒå‚æ•°ç±»å‹](#modify-the-orm-transaction-method-callback-parameter-type)
- [ä¼˜åŒ– Orm çš„ Delete å’Œ ForceDelete æ–¹æ³•](#optimize-the-delete-and-forcedelete-methods-of-orm)
- [ä¼˜åŒ– Cache çš„ Decrement å’Œ Increment æ–¹æ³•](#optimize-the-decrement-and-increment-methods-of-cache)
- [ä¼˜åŒ– Artisan çš„ Call æ–¹æ³•](#optimize-the-call-method-of-artisan)
- [å°† Testing.Database çš„ Clear æ–¹æ³•é‡å‘½åä¸º Shutdown](#rename-the-clear-method-of-testing-database-to-shutdown)
- [ä¼˜åŒ– Testing.Database çš„ Build æ–¹æ³•](#optimize-the-build-method-of-testing-database)
- [ä¼˜åŒ– Request.Input\* æ–¹æ³•](#optimize-the-request-input-method)
- [ä¼˜åŒ– validation.PrepareForValidation æ–¹æ³•](#optimize-the-validation-prepareforvalidation-method)
- [ä¼˜åŒ– Queue æ¨¡å—çš„ Worker æ–¹æ³•](#optimize-the-worker-method-of-the-queue-module)

## v1.15.3

- [Go Migration æ”¯æŒ Boolean å­—æ®µ](#go-migration-supports-boolean-field)
- [Go Migration æ”¯æŒè‡ªå®šä¹‰å­—æ®µ](#go-migration-supports-custom-field)
- [ä¼˜åŒ– Artisan æ—¥å¿—è¾“å‡ºè§„åˆ™](#optimize-artisan-log-output-rules)

## v1.15.4

å‡çº§ç›¸å…³åŒ…ï¼šgoravel/gin: v1.3.3, goravel/fiber: v1.3.3

- [ä¿®å¤ PrepareForValidation ä¸­ ctx ä¸º nil çš„é—®é¢˜](#fix-the-problem-that-ctx-is-nil-in-prepareforvalidation)
- [ä¿®å¤åœ¨é«˜å¹¶å‘ä¸‹ Fiber é©±åŠ¨ä¸­ Orm WithContext æ–¹æ³•æŠ¥é”™çš„é—®é¢˜](#fix-the-problem-that-the-orm-withcontext-method-reports-an-error-in-fiber-driver-under-high-concurrency)
- [ä¼˜åŒ–æ‰“åŒ…ä½“ç§¯](#optimize-the-packaging-volume)
- [ä¼˜åŒ–æ¨¡å‹ ID å¤šæ¬¡åµŒå¥—çš„é—®é¢˜](#optimize-the-problem-that-the-model-id-is-nested-multiple-times)
- [æ·»åŠ  artisan å‘½ä»¤åˆ«å](#add-artisan-command-alias)

## v1.15.5

å‡çº§ç›¸å…³åŒ…ï¼šgoravel/redis: v1.3.1, goravel/fiber: v1.3.4

- [ä¿®å¤ Throttle åœ¨ Redis é©±åŠ¨ä¸­å­˜å‚¨å¤±è´¥çš„é—®é¢˜](#fix-the-problem-that-throttle-fails-to-store-in-redis-driver)
- [ä¿®å¤ Fallback åœ¨ Fiber é©±åŠ¨ä¸­æ— æ³•å·¥ä½œçš„é—®é¢˜](#fix-the-problem-that-fallback-fails-to-work-in-fiber-driver)

## v1.15.6

- [ä¿®å¤ Orm WithContext æ–¹æ³•åœ¨å¹¶å‘æ‰§è¡Œæ—¶æŠ¥é”™çš„é—®é¢˜](#fix-the-problem-that-the-orm-withcontext-method-reports-an-error-in-concurrent-execution)

## v1.15.7

- [å‡çº§ Carbon](#å‡çº§-carbon)

## v1.15.8

åŒæ—¶å‡çº§ï¼šgoravel/fiber: v1.3.6

- [ä¿®å¤ facades.Testing().Docker().Database() å¼‚å¸¸çš„é—®é¢˜](#ä¿®å¤-facades-testing-docker-database-å¼‚å¸¸çš„é—®é¢˜)
- [ä¿®å¤ fiber é©±åŠ¨ ctx.Request().Ip() è·å– IP æ— æ•ˆçš„é—®é¢˜](#ä¿®å¤-fiber-é©±åŠ¨-ctx-request-ip-è·å–-ip-æ— æ•ˆçš„é—®é¢˜)
- [Orm ä¸­ WhereBetween ç›¸å…³æ–¹æ³•ä¸æ”¯æŒå­—ç¬¦ä¸²çš„é—®é¢˜](#orm-ä¸­-wherebetween-ç›¸å…³æ–¹æ³•ä¸æ”¯æŒå­—ç¬¦ä¸²çš„é—®é¢˜)

## v1.15.9

- [ä¿®å¤ Orm ä¸­ Cursor æ–¹æ³•åœ¨æŸäº›æƒ…å†µä¸‹å†…å­˜æ³„éœ²çš„é—®é¢˜](#ä¿®å¤-orm-ä¸­-cursor-æ–¹æ³•åœ¨æŸäº›æƒ…å†µä¸‹å†…å­˜æ³„éœ²çš„é—®é¢˜)
- [ä¿®å¤ Schedule ä¸­ä½¿ç”¨ç§’çº§ä»»åŠ¡æ—¶ OnOneServer å¼‚å¸¸çš„é—®é¢˜](#ä¿®å¤-schedule-ä¸­ä½¿ç”¨ç§’çº§ä»»åŠ¡æ—¶-ononeserver-å¼‚å¸¸çš„é—®é¢˜)
- [make:migration å‘½ä»¤ç”Ÿæˆçš„è¿ç§»æ–‡ä»¶ä¸­é»˜è®¤ Timestamps æ”¹ä¸º TimestampsTz](#make-migration-å‘½ä»¤ç”Ÿæˆçš„è¿ç§»æ–‡ä»¶ä¸­é»˜è®¤-timestamps-æ”¹ä¸º-timestampstz)

## v1.15.10

- [ä¿®å¤ Orm Query åœ¨é‡å¤ä½¿ç”¨æ—¶ Where æ¡ä»¶å¯èƒ½é”™ä¹±çš„é—®é¢˜](#ä¿®å¤-orm-query-åœ¨é‡å¤ä½¿ç”¨æ—¶-where-æ¡ä»¶å¯èƒ½é”™ä¹±çš„é—®é¢˜)

## å‡çº§æŒ‡å—

**é¢„è®¡å‡çº§æ—¶é—´ï¼š10åˆ†é’Ÿ**

éšç€ [Golang v1.21 ä¸å†è¢«ç»´æŠ¤](https://endoflife.date/go)ï¼ŒGoravel v1.15 é»˜è®¤æ”¯æŒ Golang ç‰ˆæœ¬ç”± 1.21 å‡çº§ä¸º 1.22ï¼Œè¯·åœ¨ go.mod æ–‡ä»¶ä¸­æ›´æ–°ç‰ˆæœ¬ã€‚ Please update the version in the go.mod file.

### 1. 1ã€‚ æ›´æ–°ä¾èµ–

```
go get -u github.com/goravel/framework@v1.15.2

// å¦‚æœä½¿ç”¨ gin
go get -u github.com/goravel/gin@v1.3.2

// å¦‚æœä½¿ç”¨ fiber
go get -u github.com/goravel/fiber@v1.3.2

// å¦‚æœä½¿ç”¨ redis
go get -u github.com/goravel/redis@v1.3.0

// å¦‚æœä½¿ç”¨ S3
go get -u github.com/goravel/s3@v1.3.2

// å¦‚æœä½¿ç”¨ Oss
go get -u github.com/goravel/oss@v1.3.2

// å¦‚æœä½¿ç”¨ Cos
go get -u github.com/goravel/cos@v1.3.2

// å¦‚æœä½¿ç”¨ Minio
go get -u github.com/goravel/minio@v1.3.2

// å¦‚æœä½¿ç”¨ Cloudinary
go get -u github.com/goravel/cloudinary@v1.3.1
```

```
go mod tidy
```

### 6. å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Queue æ¨¡å—çš„ Worker æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[Postgresql é©±åŠ¨åç§°æ›´æ”¹ä¸º Postgres](#the-name-of-postgresql-driver-changes-to-postgres)

### 4. å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Orm çš„ Delete æˆ– ForceDelete æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[ä¿®æ”¹ Orm.Transaction æ–¹æ³•å›è°ƒå‚æ•°ç±»å‹](#modify-the-ormtransaction-method-callback-parameter-type)

### 5. å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Cache çš„ Decrement å’Œ Increment æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[ä¼˜åŒ– Orm çš„ Delete å’Œ ForceDelete æ–¹æ³•](#optimize-the-delete-and-forcedelete-methods-of-orm)

### 7. å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Artisan çš„ Call æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[ä¼˜åŒ– Cache çš„ Decrement å’Œ Increment æ–¹æ³•](#optimize-the-decrement-and-increment-methods-of-cache)

### 6. å¦‚æœæ­£åœ¨ä½¿ç”¨ Queue æ¨¡å—çš„ Worker æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[ä¼˜åŒ– Queue æ¨¡å—çš„ Worker æ–¹æ³•](#optimize-the-worker-method-of-the-queue-module)

### 7. å¦‚æœæ­£åœ¨ä½¿ç”¨ Artisan çš„ Call æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[ä¼˜åŒ– Request.Input\* æ–¹æ³•](#optimize-the-request-input-method)

### 8. 8ã€‚ å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Testing.Database çš„ Clear æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[å°† Testing.Database çš„ Clear æ–¹æ³•é‡å‘½åä¸º Shutdown](#rename-the-clear-method-of-testing-database-to-shutdown)

### 9. å¦‚æœæ­£åœ¨ä½¿ç”¨ Testing.Database çš„ Build æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[ä¼˜åŒ– Testing.Database çš„ Build æ–¹æ³•](#optimize-the-build-method-of-testing-database)

### 10. å¦‚æœæ­£åœ¨ä½¿ç”¨ Migration æ¨¡å—

ä¿®æ”¹ `config/database.go` ä¸­çš„é…ç½®ï¼š

```go
-- "migrations": "migrations",
++ "migrations": map[string]any{
++  "driver": "sql",
++  "table":  "migrations",
++ },
```

### 11. 11ã€‚ å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Request.Input\* æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[ä¼˜åŒ– Artisan çš„ Call æ–¹æ³•](#optimize-the-call-method-of-artisan)

### 12. å¦‚æœæ­£åœ¨ä½¿ç”¨ validation.PrepareForValidation æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[ä¼˜åŒ– validation.PrepareForValidation æ–¹æ³•](#optimize-the-validation-prepareforvalidation-method)

### 13. 13ã€‚ å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Mail æ¨¡å—

ä¿®æ”¹ `Subject` çš„è®¾ç½®æ–¹å¼ï¼š

```go
-- import "github.com/goravel/framework/contracts/mail"
++ import "github.com/goravel/framework/mail"

-- facades.Mail().Content(mail.Content{Subject: "Subject", Html: "<h1>Hello Goravel</h1>"})
++ facades.Mail().Content(mail.Html("<h1>Hello Goravel</h1>")).Subject("Subject")
```

å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ `From` æ–¹æ³•ï¼š

```go
-- import "github.com/goravel/framework/contracts/mail"
++ import "github.com/goravel/framework/mail"

-- facades.Mail().From(mail.From{Address: testFromAddress, Name: testFromName})
++ facades.Mail().From(mail.Address(testFromAddress, testFromName))
```

å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ `Queue` æ–¹æ³•ï¼š

```go
-- import "github.com/goravel/framework/contracts/mail"
++ import "github.com/goravel/framework/mail"

-- facades.Mail().Queue(mail.Queue{Connection: "high", Queue: "mail"})
++ facades.Mail().Queue(mail.Queue().Connection("high").Queue("mail"))
```

### 14. 12ã€‚ å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ validation.PrepareForValidation æ–¹æ³•

éœ€è¦ç›¸åº”ä¿®æ”¹ï¼š[ä¼˜åŒ– validation.PrepareForValidation æ–¹æ³•](#optimize-the-validation-prepareforvalidation-method)

## åŠŸèƒ½ä»‹ç»

### è¿ç§»æ”¯æŒä½¿ç”¨ Go è¯­è¨€è¿ç§»

ä¹‹å‰æ¡†æ¶ä»…æ”¯æŒ SQL è¿ç§»ï¼Œå½“æƒ³è¦åˆ‡æ¢æ•°æ®åº“æ—¶ï¼Œç”±äºä¸åŒæ•°æ®åº“é—´çš„ SQL è¯­æ³•å·®å¼‚ï¼Œå°†ä½¿è¿ç§»è¿‡ç¨‹æå…¶å›°éš¾ã€‚æ­¤å¤–ï¼Œè¿ç§»æ–‡ä»¶ä¸­ä¹Ÿæ— æ³•æ‰§è¡Œä»£ç ï¼Œåœ¨è¿›è¡Œæ•°æ®ä¿®å¤æ—¶ï¼Œæ— æ³•è¿›è¡Œé€»è¾‘åˆ¤æ–­ã€‚ When you wanted to switch databases, the differences in SQL syntax between different databases made the migration process extremely difficult. In addition, code could not be executed in migration files, making it impossible to perform logical judgments when repairing data.

Now, the framework supports generating migration files directly using Go language, making it easy for developers to write complex migration logic. However, in the current version, the modification of table fields has not been implemented, only supporting operations such as creating tables, deleting tables, and creating indexes. If you want to make modifications, you need to use the `Sql` method to execute SQL statements directly. The ability to modify table fields will be supported in future versions.

åœ¨ v1.15 ç‰ˆæœ¬ä¸­ï¼Œæ¡†æ¶åŒæ—¶æ”¯æŒ Go è¯­è¨€è¿ç§»ï¼ˆé»˜è®¤ï¼‰å’Œ SQL è¿ç§»ï¼Œä½† SQL è¿ç§»å°†åœ¨ v1.16 ç‰ˆæœ¬ä¸­è¢«ç§»é™¤ã€‚

#### ä» SQL è¿ç§»åˆ‡æ¢åˆ° Go è¯­è¨€è¿ç§»

å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ SQL è¿ç§»ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤åˆ‡æ¢åˆ° Go è¯­è¨€è¿ç§»ï¼š

1. ä¿®æ”¹ `config/database.go` ä¸­çš„é…ç½®ï¼›

```go
-- "migrations": "migrations",
++ "migrations": map[string]any{
++  "driver": "default",
++  "table":  "migrations",
++ },
```

2. ä½¿ç”¨ `go run . artisan make:migration {NAME}` å‘½ä»¤åˆ›å»ºè¿ç§»æ–‡ä»¶ï¼›

åœ¨ç”Ÿæˆçš„æ–‡ä»¶çš„ `Up` å’Œ `Down` æ–¹æ³•ä¸­æ‰§è¡ŒåŸå§‹ SQL è¿ç§»æ–‡ä»¶ä¸­çš„è¿ç§»å’Œå›æ»šè¯­å¥ï¼Œå¹¶ä½¿ç”¨ `facades.Schema().HasTable` æ–¹æ³•æ£€æŸ¥è¡¨æ˜¯å¦å­˜åœ¨ï¼š

```go
func (r *M20241207095921CreateUsersTable) Up() error {
  if !facades.Schema().HasTable("users") {
    return facades.Schema().Sql({SQL})
  }

  return nil
}
```

3. åœ¨ `database/kernel.go` æ–‡ä»¶ä¸­æ³¨å†Œè¿ç§»æ–‡ä»¶ï¼›

åˆ›å»ºä¸€ä¸ªæ–°çš„ `database/kernel.go` æ–‡ä»¶å¹¶æ³¨å†Œè¿ç§»æ–‡ä»¶å’Œç§å­ï¼š

```go
package database

import (
  "github.com/goravel/framework/contracts/database/schema"
  "github.com/goravel/framework/contracts/database/seeder"

  "goravel/database/migrations"
  "goravel/database/seeders"
)

type Kernel struct {
}

func (kernel Kernel) Migrations() []schema.Migration {
  return []schema.Migration{
    &migrations.M20241207095921CreateUsersTable{},
  }
}

func (kernel Kernel) Seeders() []seeder.Seeder {
  return []seeder.Seeder{
    &seeders.DatabaseSeeder{},
  }
}
```

4. ä¿®æ”¹ `app/providers/database_service_provider.go` æ–‡ä»¶å®Œæˆæ³¨å†Œï¼Œå¹¶å°†åŸæœ¬åœ¨è¿™é‡Œæ³¨å†Œçš„ `Seeder` ç§»åŠ¨åˆ° `database/kernel.go::Seeders`ï¼›

```go
-- func (receiver *DatabaseServiceProvider) Boot(app foundation.Application) {
--  facades.Seeder().Register([]seeder.Seeder{
--   &seeders.DatabaseSeeder{},
--  })
-- }
++ func (receiver *DatabaseServiceProvider) Boot(app foundation.Application) {
++  kernel := database.Kernel{}
++  facades.Schema().Register(kernel.Migrations())
++  facades.Seeder().Register(kernel.Seeders())
++ }
```

5. å¤‡ä»½ç°æœ‰çš„ `migrations` è¡¨æ•°æ®ï¼Œç„¶ååˆ é™¤ `migrations` è¡¨ï¼›

6. æ‰§è¡Œ `go run . artisan migrate` å‘½ä»¤è¿›è¡Œè¿ç§»ï¼Œè¿ç§»å®Œæˆåï¼Œå°†ç”Ÿæˆæ–°çš„ `migrations` è¡¨ã€‚

[æŸ¥çœ‹æ–‡æ¡£](../orm/migrations)

### æµ‹è¯•æ”¯æŒ HTTP æµ‹è¯•

goravel/framework: v1.15.0

æ¡†æ¶æ–°å¢äº† `Testing.Http` æ¨¡å—ï¼Œæ”¯æŒ HTTP è¯·æ±‚æµ‹è¯•ï¼Œå¯ä»¥æ¨¡æ‹Ÿè¯·æ±‚ã€è·å–å“åº”ã€æ–­è¨€å“åº”ã€‚

[æŸ¥çœ‹æ–‡æ¡£](../testing/http)

### HTTP æ”¯æŒè¿”å›æµ

goravel/framework: v1.15.0

[æŸ¥çœ‹æ–‡æ¡£](../basic/responses#return-stream)

### HTTP æ”¯æŒè®¾ç½®è¶…æ—¶

goravel/framework: v1.15.0

æ‚¨å¯ä»¥é€šè¿‡åœ¨ `config/http.go` æ–‡ä»¶ä¸­é…ç½® `http.request_timeout` æ¥è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º 3 ç§’ã€‚

### HTTP æ”¯æŒè®¾ç½®è‡ªå®šä¹‰æ¢å¤æ–¹æ³•

goravel/framework: v1.15.0

[æŸ¥çœ‹æ–‡æ¡£](../basic/requests#custom-recovery)

### è¯·æ±‚æ”¯æŒé…ç½®è¿‡æ»¤å™¨

goravel/framework: v1.15.0

[æŸ¥çœ‹æ–‡æ¡£](../basic/validation#filter-input-data)

### è¯·æ±‚æ·»åŠ äº† BindQuery æ–¹æ³•

goravel/framework: v1.15.0

æ”¯æŒä½¿ç”¨ `ctx.Request().BindQuery()` ç›´æ¥ä»é“¾æ¥ç»‘å®šå‚æ•°ã€‚

[æŸ¥çœ‹æ–‡æ¡£](../basic/requests#bind-query)

### éªŒè¯æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼è§„åˆ™

goravel/framework: v1.15.0

```go
validator, err := ctx.Request().Validate(map[string]string{
  "code": `required|regex:^\d{4,6}$`,
})
```

### è°ƒåº¦æ”¯æŒæ§åˆ¶æ—¥å¿—è¾“å‡º

goravel/framework: v1.15.0

å½“ `app.debug` ä¸º `false` æ—¶ï¼Œåªä¼šè¾“å‡º `error` çº§åˆ«çš„æ—¥å¿—ã€‚

### è°ƒåº¦æ·»åŠ  Shutdown æ–¹æ³•

goravel/framework: v1.15.0

`Shutdown` æ–¹æ³•å¯ç”¨äºä¼˜é›…åœ°åœæ­¢è°ƒåº¦ã€‚

[æŸ¥çœ‹æ–‡æ¡£](../advanced/schedule#stopping-the-scheduler)

### Mail æ”¯æŒ Mailable æ¨¡æ¿

goravel/framework: v1.15.0

[æŸ¥çœ‹æ–‡æ¡£](../advanced/mail#using-mailable)

### é”™è¯¯æ—¥å¿—è¾“å‡ºä¸­çš„è·Ÿè¸ªæ”¯æŒè·³è½¬

goravel/framework: v1.15.0

åœ¨é”™è¯¯æ—¥å¿—è¾“å‡ºä¸­ï¼Œç‚¹å‡»è·Ÿè¸ªå°†è·³è½¬åˆ°å‘ç”Ÿé”™è¯¯çš„ä»£ç è¡Œã€‚

### Log æ”¯æŒæ‰“å° Context ä¸­çš„é”®å€¼å¯¹

goravel/framework: v1.15.0

```go
ctx.WithValue("a", "b")
facades.Log().WithContext(ctx).Info("Hello Goravel")

// è¾“å‡ºï¼š
[2024-12-15 16:36:58] local.info: Hello Goravel 
Context: map[a:b]
```

### æ”¯æŒç›´æ¥è®¾ç½® DSN è¿æ¥æ•°æ®åº“

goravel/framework: v1.15.0

[æŸ¥çœ‹æ–‡æ¡£](../orm/getting-started#dsn)

### Orm çš„ Create æ–¹æ³•æ”¯æŒä½¿ç”¨ map åˆ›å»º

goravel/framework: v1.15.0

[æŸ¥çœ‹æ–‡æ¡£](../orm/getting-started#create)

### Orm æ·»åŠ é…ç½®é¡¹

goravel/framework: v1.15.0

è¿™äº›é…ç½®é¡¹é’ˆå¯¹ç‰¹å®šæƒ…å†µä½¿ç”¨ï¼Œæ­£å¸¸ä½¿ç”¨ä¸éœ€è¦ï¼Œé»˜è®¤ä¸æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚

```go
// config/database.go
"{driver_name}": map[string]any{
  "driver":   "{driver_name}",
  "host":     config.Env("DB_HOST", "127.0.0.1"),
  ...
++ "schema": "goravel",// Set the default schema for the connection, only for Postgres and SQL Server
++ "no_lower_case": false,// Set whether to convert the table name to lowercase
++ "name_replacer": strings.NewReplacer("id", "ID"),// Set the columns name replacement
},
```

### Orm æ·»åŠ  Restore æ–¹æ³•

goravel/framework: v1.15.0

åœ¨ `Orm` æ¨¡å—ä¸­æ·»åŠ  `Restore` æ–¹æ³•ï¼Œå¯ç”¨äºæ¢å¤è½¯åˆ é™¤çš„æ•°æ®ï¼Œå¹¶æ·»åŠ  `Restored`ã€`Restoring` äº‹ä»¶ã€‚

[æŸ¥çœ‹æ–‡æ¡£](../orm/getting-started#restore)

### Orm çš„æ—¥å¿—é›†æˆåˆ° Log æ¨¡å—

goravel/framework: v1.15.0

ä¹‹å‰ï¼ŒOrm çš„æ—¥å¿—è¾“å‡ºæ˜¯ç›´æ¥è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œç°åœ¨ Orm çš„æ—¥å¿—è¾“å‡ºå°†é›†æˆåˆ° Log æ¨¡å—ä¸­ï¼Œå¯ä»¥åŒæ—¶æ‰“å°åˆ°æ§åˆ¶å°å’Œæ—¥å¿—æ–‡ä»¶ã€‚

### Postgres å’Œ SQL Server é©±åŠ¨ç¨‹åºæ”¯æŒ Schema

goravel/framework: v1.15.0

[æŸ¥çœ‹æ–‡æ¡£](../orm/getting-started#schema)

### æ·»åŠ  about å‘½ä»¤

goravel/framework: v1.15.0

æ·»åŠ  `about` å‘½ä»¤ï¼Œå¯ç”¨äºæŸ¥çœ‹æ¡†æ¶ç‰ˆæœ¬ã€é…ç½®ç­‰ä¿¡æ¯ã€‚

```bash
go run . artisan about
```

### æ·»åŠ  db:show å‘½ä»¤

goravel/framework: v1.15.0

æ·»åŠ  `db:show` å‘½ä»¤ï¼Œå¯ç”¨äºæŸ¥çœ‹æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€‚

```bash
go run . artisan db:show
```

### æ·»åŠ  db:table å‘½ä»¤

goravel/framework: v1.15.0

æ·»åŠ  `db:table` å‘½ä»¤ï¼Œå¯ç”¨äºæŸ¥çœ‹è¡¨ç»“æ„ã€‚

```bash
go run . artisan db:table
go run . artisan db:table users
```

### ä¼˜åŒ– Artisan è¾“å‡ºæ ·å¼

goravel/framework: v1.15.0

ä¼˜åŒ– Artisan è¾“å‡ºæ ·å¼ï¼Œæ·»åŠ é¢œè‰²ï¼Œä½¿è¾“å‡ºæ›´ç¾è§‚ã€‚

### Auth æ·»åŠ  Id æ–¹æ³•

goravel/framework: v1.15.0

```go
id, err := facades.Auth(ctx).ID()
```

### å¤šä¸ª Auth.Guard å¯ä»¥è®¾ç½®è‡ªå·±çš„ TTL

goravel/framework: v1.15.0

Previously, multiple Guards shared the `jwt.ttl` configuration. ä¹‹å‰å¤šä¸ª Guard å…¬ç”¨ `jwt.ttl` é…ç½®ï¼Œç°åœ¨ä½ å¯ä»¥é€šè¿‡åœ¨ `config/auth.go` æ–‡ä»¶ä¸­ä¸ºæ¯ä¸ª Guard å•ç‹¬è®¾ç½® TTLï¼Œå¦‚æœä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤ä½¿ç”¨ `jwt.ttl` é…ç½®ã€‚ If not set, the `jwt.ttl` configuration will be used by default.

```go
// config/auth.go
"guards": map[string]any{
  "user": map[string]any{
    "driver": "jwt",
++  "ttl": 60,
  },
},
```

### Postgresql é©±åŠ¨ç¨‹åºåç§°æ›´æ”¹ä¸º Postgres

goravel/framework: v1.15.0

The name of the Postgresql driver has been changed to `postgres`. Postgresql é©±åŠ¨çš„åç§°å·²æ›´æ”¹ä¸º `postgres`ï¼Œå¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Postgresql é©±åŠ¨ç¨‹åºï¼Œåˆ™éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š

```go
// config/database.go
"postgres": map[string]any{
  -- "driver":   "postgresql",
  ++ "driver":   "postgres",
  "host":     config.Env("DB_HOST", "127.0.0.1"),
}
```

### ä¿®æ”¹ Orm.Transaction æ–¹æ³•å›è°ƒå‚æ•°ç±»å‹

goravel/framework: v1.15.0

`facades.Orm().Transaction()` æ–¹æ³•å›è°ƒå‚æ•°ç±»å‹å·²ä» `func(tx orm.Transaction) error` æ›´æ”¹ä¸º `func(tx orm.Query) error`ï¼Œå¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨æ­¤æ–¹æ³•ï¼Œè¯·ç›¸åº”åœ°è¿›è¡Œä¿®æ”¹ã€‚

```go
-- facades.Orm().Transaction(func(tx orm.Transaction) error {
++ facades.Orm().Transaction(func(tx orm.Query) error {
  var user models.User

  return tx.Find(&user, user.ID)
})
```

### ä¼˜åŒ– Orm çš„ Delete å’Œ ForceDelete æ–¹æ³•

goravel/framework: v1.15.0

å¦‚æœæ‚¨æ­£åœ¨å‘ `Delete` æˆ– `ForceDelete` æ–¹æ³•ä¼ é€’ ID æ¥åˆ é™¤æ•°æ®ï¼Œè¯·æ”¹ç”¨ `Where` æ–¹æ³•ï¼š

```go
-- facades.Orm().Query().Delete(&models.User{}, 10)
++ facades.Orm().Query().Where("id", 10).Delete(&models.User{})

-- facades.Orm().Query().Delete(&models.User{}, []uint{1, 2, 3})
++ facades.Orm().Query().WhereIn("id", []uint{1, 2, 3}).Delete(&models.User{})

-- facades.Orm().Query().ForceDelete(&models.User{}, 10)
++ facades.Orm().Query().ForceDelete("id", 10).Delete(&models.User{})
```

`Delete` å’Œ `ForceDelete` æ–¹æ³•æ”¯æŒä¸ä¼ é€’å‚æ•°åˆ é™¤æ•°æ®ï¼š

```go
res, err := facades.Orm().Query().Model(&models.User{}).Where("id", 1).Delete()
res, err := facades.Orm().Query().Table("users").Where("id", 1).Delete()
```

### ä¼˜åŒ– Cache çš„ Decrement å’Œ Increment æ–¹æ³•

goravel/framework: v1.15.0

æ–¹æ³• `Decrement` å’Œ `Increment` çš„è¾“å…¥å’Œè¾“å‡ºç±»å‹å·²ä» `int` æ›´æ”¹ä¸º `int64`ï¼š

```go
-- Decrement(key string, value ...int) (int, error)
++ Decrement(key string, value ...int64) (int64, error)

-- Increment(key string, value ...int) (int, error)
++ Increment(key string, value ...int64) (int64, error)
```

### ä¼˜åŒ– Artisan çš„ Call æ–¹æ³•

goravel/framework: v1.15.0

ä¹‹å‰ `facades.Artisan().Call()` æ–¹æ³•æ‰§è¡Œæ—¶é‡åˆ°é”™è¯¯å°†ä¼šç›´æ¥ panicï¼Œç°åœ¨å°†è¿”å›é”™è¯¯ï¼Œå¦‚æœä½ æ­£åœ¨ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œè¯·å¤„ç†è¯¥é”™è¯¯è¿”å›ã€‚ It now returns an error, so handle the error if you are using this method.

```go
err := facades.Artisan().Call("command:name")
```

### å°† Testing.Database çš„ Clear æ–¹æ³•é‡å‘½åä¸º Shutdown

goravel/framework: v1.15.0

ä¸ºäº†ä¿æŒæ–¹æ³•åç§°ä¸å…¶ä»–æ¨¡å—ä¸€è‡´ï¼Œæˆ‘ä»¬å°† `Clear` æ–¹æ³•é‡å‘½åä¸º `Shutdown`ã€‚

```go
database, err := facades.Testing().Docker().Database()
-- err := database.Clear()
++ err := database.Shutdown()
```

### ä¼˜åŒ– Testing.Database çš„ Build æ–¹æ³•

goravel/framework: v1.15.0

Previously, when calling the `Build` method, the database migration would be performed automatically. ä¹‹å‰åœ¨è°ƒç”¨ `Build` æ–¹æ³•æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œæ•°æ®åº“è¿ç§»ï¼Œå‡çº§åï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨ `Migrate` æ–¹æ³•è¿›è¡Œè¿ç§»ï¼Œæ•°æ®åº“æ§åˆ¶æ›´åŠ çµæ´»ã€‚

```go
database, err := facades.Testing().Docker().Database()
err := database.Build()
++ err := database.Migrate()
```

### ä¼˜åŒ– Request.Input\* æ–¹æ³•

goravel/framework: v1.15.0

goravel/gin: v1.3.0

goravel/fiber: v1.3.0

ä¹‹å‰ `Request.Input*` æ–¹æ³•ä»…èƒ½è·å– `Body` ä¸­çš„æ•°æ®ï¼Œç°åœ¨å°†ä¾æ¬¡æŸ¥æ‰¾ `Body`ã€ `Query`ã€`Param`ã€‚å¹¶ä¸”ä¹‹å‰å‘ `Request.Input*` æ–¹æ³•ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°(é»˜è®¤å€¼)æ—¶ï¼Œå¦‚æœ `key` å­˜åœ¨ï¼Œä½†ç½®ä¸ºç©ºï¼Œå°†è¿”å›é»˜è®¤å€¼ï¼Œç°åœ¨å°†è¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œå› ä¸ºç©ºå­—ç¬¦ä¸²ä¹Ÿæ˜¯ä¸€ç§æœ‰æ•ˆå€¼ï¼Œåªæœ‰å½“ key ä¸å­˜åœ¨æ—¶ï¼Œæ‰è¿”å›é»˜è®¤å€¼ã€‚ Previously, when passing a second parameter (default value) to the `Request.Input*` method, if the `key` existed but was empty, the default value would be returned. Now, an empty string will be returned, as an empty string is also a valid value, only when the `key` does not exist, the default value will be returned.

ä½ éœ€è¦æ£€æŸ¥æ‰€æœ‰ä½¿ç”¨ `Request.Input*` æ–¹æ³•çš„åœ°æ–¹ï¼Œä»¥ç¡®ä¿ä¼ é€’çš„å‚æ•°æ­£ç¡®ï¼Œå¹¶ä¸”è¿”å›å€¼ç¬¦åˆé¢„æœŸã€‚

### ä¼˜åŒ– validation.PrepareForValidation æ–¹æ³•

goravel/framework: v1.15.0

ä¿®æ”¹è¾“å…¥å‚æ•°ç±»å‹å¹¶æ·»åŠ  `http.Context` å‚æ•°ï¼š

```go
import github.com/goravel/framework/validation

-- validator, err := facades.Validation().Make(input, rules, validation.PrepareForValidation(func(data validationcontract.Data) error {
++ validator, err := facades.Validation().Make(input, rules, validation.PrepareForValidation(func(ctx http.Context, data validationcontract.Data) error {
  if name, exist := data.Get("name"); exist {
 return data.Set("name", name)
  }

  return nil
}))
```

### ä¼˜åŒ–é˜Ÿåˆ—æ¨¡å—çš„ Worker æ–¹æ³•

goravel/framework: v1.15.0

å½“ `Worker` æ–¹æ³•ä¸éœ€è¦è®¾ç½®å‚æ•°æ—¶ï¼Œå¯ä»¥ä¿æŒä¸ºç©ºï¼š

```go
-- facades.Queue().Worker(nil).Run()
++ facades.Queue().Worker().Run()
```

å½“éœ€è¦è®¾ç½®å‚æ•°æ—¶ï¼Œå‚æ•°ä»æŒ‡é’ˆæ”¹ä¸ºå®ä¾‹ï¼š

```go
-- facades.Queue().Worker(&queue.Args{Connection: "redis").Run()
++ facades.Queue().Worker(queue.Args{Connection: "redis"}).Run()
```

### Go è¿ç§»æ”¯æŒå¸ƒå°”å­—æ®µ

goravel/framework: v1.15.3

```go
table.Boolean("is_admin")
```

### Go Migration æ”¯æŒè‡ªå®šä¹‰å­—æ®µ

goravel/framework: v1.15.3

å¦‚æœæ‚¨ä½¿ç”¨çš„åˆ—ç±»å‹æ¡†æ¶å°šä¸æ”¯æŒï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `Column` æ–¹æ³•æ¥è‡ªå®šä¹‰å­—æ®µç±»å‹ï¼š

```go
table.Column("geometry", "geometry")
```

### ä¼˜åŒ– Artisan æ—¥å¿—è¾“å‡ºè§„åˆ™

goravel/framework: v1.15.3

Previously, Artisan log only output error level logs, now all levels of logs will be output. ä¹‹å‰ Artisan æ—¥å¿—åªè¾“å‡ºé”™è¯¯çº§åˆ«çš„æ—¥å¿—ï¼Œç°åœ¨æ‰€æœ‰çº§åˆ«çš„æ—¥å¿—éƒ½ä¼šè¾“å‡ºã€‚ å¦‚æœæ‚¨æƒ³ç¦ç”¨æ§åˆ¶å°æ‰“å°æ—¥å¿—ï¼Œå¹¶ä¸”ä½¿ç”¨çš„æ˜¯ `single` æˆ– `daily` æ—¥å¿—é©±åŠ¨ï¼Œè¯·å°† `logging.channels.single.print` æˆ– `logging.channels.daily.print` é…ç½®è®¾ç½®ä¸º `false`ã€‚

### ä¿®å¤ PrepareForValidation ä¸­ ctx ä¸º nil çš„é—®é¢˜

goravel/framework: v1.15.4

goravel/gin: v1.3.3

goravel/fiber: v1.3.3

åœ¨ä¿®å¤ä¹‹å‰ï¼Œ`PrepareForValidation` æ–¹æ³•ä¸­çš„ `ctx` å§‹ç»ˆä¸º `nil`ï¼Œç°åœ¨å®ƒå°†ä½œä¸ºå‚æ•°æ­£ç¡®ä¼ é€’ã€‚ å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ `validation.PrepareForValidation` æ–¹æ³•ï¼Œè¯·ç›¸åº”åœ°è¿›è¡Œä¿®æ”¹ã€‚ If you are using the `validation.PrepareForValidation` method, please modify accordingly.

```go
import (
  github.com/goravel/framework/validation
  contarctsvalidate "github.com/goravel/framework/contracts/validation"
)

-- validation.PrepareForValidation(func(ctx http.Context, data contarctsvalidate.Data) error {
++ validation.PrepareForValidation(ctx, func(ctx http.Context, data contarctsvalidate.Data) error {
```

### ä¿®å¤åœ¨ Fiber é©±åŠ¨ç¨‹åºä¸‹é«˜å¹¶å‘æ—¶ Orm WithContext æ–¹æ³•æŠ¥é”™çš„é—®é¢˜

goravel/framework: v1.15.4

goravel/fiber: v1.3.3

è¯¦æƒ…è¯·å‚é˜…ï¼š[#866](https://github.com/goravel/framework/pull/866)

### ä¼˜åŒ–æ‰“åŒ…ä½“ç§¯

goravel/framework: v1.15.4

è¯¦æƒ…è¯·å‚é˜…ï¼š[#865](https://github.com/goravel/framework/pull/865)

### ä¼˜åŒ–æ¨¡å‹ ID å¤šæ¬¡åµŒå¥—çš„é—®é¢˜

goravel/framework: v1.15.4

è¯¦æƒ…è¯·å‚é˜…ï¼š[#898](https://github.com/goravel/framework/pull/898)

### æ·»åŠ  artisan å‘½ä»¤åˆ«å

goravel/framework: v1.15.4

```
// ä¹‹å‰
go run  . artisan key:generate

// ä¹‹å
./artisan key:generate
```

### ä¿®å¤ Throttle åœ¨ Redis é©±åŠ¨ä¸­å­˜å‚¨å¤±è´¥çš„é—®é¢˜

goravel/framework: v1.15.5

goravel/redis: v1.3.1

ä½¿ç”¨ Redis é©±åŠ¨æ—¶ï¼Œ`Throttle` æ— æ³•æ­£å¸¸å­˜å‚¨ï¼Œå¯¼è‡´é™åˆ¶å¤±æ•ˆã€‚

é—®é¢˜ï¼š[#625](https://github.com/goravel/goravel/issues/625)

### ä¿®å¤ Fiber é©±åŠ¨ä¸­ Fallback æ— æ³•æ­£å¸¸å·¥ä½œçš„é—®é¢˜

goravel/framework: v1.15.5

goravel/fiber: v1.3.4

ä½¿ç”¨ Fiber é©±åŠ¨æ—¶ï¼Œå¦‚æœè®¾ç½®äº† `Fallback`ï¼Œå…¶ä»–è·¯ç”±å°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚

é—®é¢˜ï¼š[#624](https://github.com/goravel/goravel/issues/624)

### ä¿®å¤ Orm WithContext æ–¹æ³•åœ¨å¹¶å‘æ‰§è¡Œæ—¶æŠ¥é”™çš„é—®é¢˜

goravel/framework: v1.15.6

åœ¨ä½¿ç”¨ `WithContext` æ–¹æ³•è®¾ç½® `Context` æ—¶ï¼Œåœ¨å¹¶å‘æ‰§è¡Œä¸­ä¼šæŠ¥é”™ã€‚

### å‡çº§ Carbon

ä¹‹å‰ï¼Œè°ƒç”¨ `Build` æ–¹æ³•æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œæ•°æ®åº“è¿ç§»ã€‚ å‡çº§åï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨ `Migrate` æ–¹æ³•æ¥æ‰§è¡Œè¿ç§»ï¼Œä½¿æ•°æ®åº“æ§åˆ¶æ›´åŠ çµæ´»ã€‚

[dromara/carbon](https://github.com/dromara/carbon) v2.5.5 or later versions have introduced new features, causing some framework functions to behave abnormally. [dromara/carbon](https://github.com/dromara/carbon) ~v2.5.5 ä»¥ä¸Šç‰ˆæœ¬å¼•å…¥äº†æ–°çš„ç‰¹æ€§ï¼Œå¯¼è‡´æ¡†æ¶éƒ¨åˆ†åŠŸèƒ½å¼‚å¸¸ã€‚æ³¨æ„ï¼Œå½“å‰å°šä¸æ”¯æŒ dromara/carbon v2.6 ä»¥ä¸Šç‰ˆæœ¬ï¼Œå°†åœ¨ Goravel v1.16 ä¸­å…¼å®¹ã€‚

### ä¿®å¤ facades.Testing().Docker().Database() å¼‚å¸¸çš„é—®é¢˜

goravel/frameworkï¼šv1.15.0

2ã€‚ å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Postgresql é©±åŠ¨

### ä¿®å¤ fiber é©±åŠ¨ ctx.Request().Ip() è·å– IP æ— æ•ˆçš„é—®é¢˜

å¦‚æœåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é”™è¯¯ï¼Œ`facades.Artisan().Call()` æ–¹æ³•å°†ä¼šå‘ç”Ÿ panicã€‚ ç°åœ¨å®ƒä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œ
æ‰€ä»¥å¦‚æœä½ ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¯·å¤„ç†è¿™ä¸ªé”™è¯¯ã€‚

Previously, the `ctx.Request().Ip()` method always returned `127.0.0.1`. ä¹‹å‰ä¸€ç›´è¿”å› `127.0.0.1`ã€‚ä¿®å¤åï¼Œæ–°å¢äº† `http.drivers.fiber.proxy_header`, `http.drivers.fiber.enable_trusted_proxy_check` å’Œ `http.drivers.fiber.trusted_proxies` é…ç½®ï¼Œç”¨äºè®¾ç½®ä»£ç†å¤´ä¸å¯ä¿¡ä»»çš„ä»£ç† IP åœ°å€ã€‚

ä¹‹å‰ï¼Œå¤šä¸ª Guards å…±äº« `jwt.ttl` é…ç½®ã€‚ ç°åœ¨æ‚¨å¯ä»¥é€šè¿‡åœ¨ `config/auth.go` æ–‡ä»¶ä¸­è®¾ç½®æ¥ä¸ºæ¯ä¸ª Guard å•ç‹¬è®¾ç½® TTLã€‚ å¦‚æœæœªè®¾ç½®ï¼Œé»˜è®¤å°†ä½¿ç”¨ `jwt.ttl` é…ç½®ã€‚

### Orm ä¸­ WhereBetween ç›¸å…³æ–¹æ³•ä¸æ”¯æŒå­—ç¬¦ä¸²çš„é—®é¢˜

goravel/frameworkï¼šv1.15.0

ç”±äº [Golang v1.21 ä¸å†ç»´æŠ¤](https://endoflife.date/go)ï¼ŒGoravel æ”¯æŒçš„ Golang ç‰ˆæœ¬å·²ä» 1.21 å‡çº§åˆ° 1.22ã€‚ è¯·æ›´æ–° go.mod æ–‡ä»¶ä¸­çš„ç‰ˆæœ¬ã€‚

### ä¿®å¤ Orm ä¸­ Cursor æ–¹æ³•åœ¨æŸäº›æƒ…å†µä¸‹å†…å­˜æ³„éœ²çš„é—®é¢˜

ç°åœ¨ï¼Œæ¡†æ¶æ”¯æŒç›´æ¥ä½¿ç”¨ Go è¯­è¨€ç”Ÿæˆè¿ç§»æ–‡ä»¶ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿè½»æ¾ç¼–å†™å¤æ‚çš„è¿ç§»é€»è¾‘ã€‚ ç„¶è€Œï¼Œåœ¨å½“å‰ç‰ˆæœ¬ä¸­ï¼Œå°šæœªå®ç°è¡¨å­—æ®µçš„ä¿®æ”¹ï¼Œä»…æ”¯æŒåˆ›å»ºè¡¨ã€åˆ é™¤è¡¨å’Œåˆ›å»ºç´¢å¼•ç­‰æ“ä½œã€‚ å¦‚æœæ‚¨æƒ³è¿›è¡Œä¿®æ”¹ï¼Œéœ€è¦ä½¿ç”¨ `Sql` æ–¹æ³•ç›´æ¥æ‰§è¡Œ SQL è¯­å¥ã€‚ åœ¨æœªæ¥ç‰ˆæœ¬ä¸­å°†æ”¯æŒä¿®æ”¹è¡¨
å­—æ®µçš„åŠŸèƒ½ã€‚

å½“è·å– `rows` æ—¶ï¼Œ`chan` æœªè¢«æ­£ç¡®å…³é—­ï¼Œå¯¼è‡´å†…å­˜æ³„éœ²ã€‚

### ä¿®å¤ Schedule ä¸­ä½¿ç”¨ç§’çº§ä»»åŠ¡æ—¶ OnOneServer å¼‚å¸¸çš„é—®é¢˜

ä¹‹å‰ï¼Œæ¡†æ¶åªæ”¯æŒ SQL è¿ç§»ã€‚ å½“æ‚¨æƒ³è¦åˆ‡æ¢æ•°æ®åº“æ—¶ï¼Œä¸åŒæ•°æ®åº“ä¹‹é—´çš„ SQL è¯­æ³•å·®å¼‚ä½¿å¾—è¿ç§»è¿‡ç¨‹å˜å¾—æå…¶å›°éš¾ã€‚ æ­¤å¤–ï¼Œæ— æ³•åœ¨è¿ç§»æ–‡ä»¶ä¸­æ‰§è¡Œä»£ç ï¼Œä½¿å¾—åœ¨ä¿®å¤æ•°æ®æ—¶æ— æ³•è¿›è¡Œé€»è¾‘åˆ¤æ–­ã€‚

ä»¥å‰ï¼Œ`Request.Input*` æ–¹æ³•åªèƒ½ä» `Body` è·å–æ•°æ®ï¼Œç°åœ¨å®ƒä¼šæŒ‰é¡ºåºä» `Body`ã€`Query` å’Œ `Param` ä¸­æŸ¥æ‰¾æ•°æ®ã€‚ ä»¥å‰ï¼Œå½“å‘ `Request.Input*` æ–¹æ³•ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼ˆé»˜è®¤å€¼ï¼‰æ—¶ï¼Œå¦‚æœ `key` å­˜åœ¨ä½†ä¸ºç©ºï¼Œåˆ™ä¼šè¿”å›é»˜è®¤å€¼ã€‚ ç°åœ¨ï¼Œå°†è¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œå› ä¸ºç©ºå­—ç¬¦ä¸²ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰æ•ˆå€¼ï¼Œåªæœ‰å½“ `key` ä¸å­˜åœ¨æ—¶ï¼Œæ‰ä¼šè¿”å›é»˜è®¤å€¼ã€‚

### make:migration å‘½ä»¤ç”Ÿæˆçš„è¿ç§»æ–‡ä»¶ä¸­é»˜è®¤ Timestamps æ”¹ä¸º TimestampsTz

Postgresql é©±åŠ¨çš„åç§°å·²æ›´æ”¹ä¸º `postgres`ã€‚ å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Postgresql é©±åŠ¨ï¼Œæ‚¨éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š

9ã€‚ å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Testing.Database çš„ Build æ–¹æ³•

### ä¿®å¤ Orm Query åœ¨é‡å¤ä½¿ç”¨æ—¶ Where æ¡ä»¶å¯èƒ½é”™ä¹±çš„é—®é¢˜

10ã€‚ å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Migration æ¨¡å—

æ‰§è¡Œ `go run .`ã€‚ artisan migrate`å‘½ä»¤æ‰§è¡Œè¿ç§»ï¼Œè¿ç§»å®Œæˆåä¼šç”Ÿæˆæ–°çš„`migrations\\` è¡¨ã€‚
