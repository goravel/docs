# 从 v1.12 升级到 v1.13

[[toc]]

### 令人兴奋的新功能 🎉

- [数据填充](#数据填充)

### 功能增强 🚀

### 破坏性变化 🛠

- [优化 facades.Cache() 中 Remember 与 RememberForever 方法](#5--修改-facades-cache-中-remember-与-rememberforever-方法（如果用到）)

### Bug 修复 🐛

- [修复 facades.Auth().User() 的问题](#修复-facades-auth-user-的问题)
- [修复 facades.Orm().Query().Load() 的问题](#修复-facades-orm-query-load-的问题)

## 升级指南

请根据本节内容，一步步进行框架升级。

**预计升级时间：5 分钟**

### 1. 更新依赖

`go.mod` 中更新依赖：

```
go get -u github.com/goravel/framework@v1.13.0 && go mod tidy
```

### 2. 新增 `database/seeders/database_seeder.go` 文件

```go
package seeders

type DatabaseSeeder struct {
}

// Signature The name and signature of the seeder.
func (s *DatabaseSeeder) Signature() string {
  return "DatabaseSeeder"
}

// Run executes the seeder logic.
func (s *DatabaseSeeder) Run() error {
  return nil
}
```

### 3. 新增 `app/providers/database_service_provider.go` 文件

```go
package providers

import (
  "github.com/goravel/framework/contracts/database/seeder"
  "github.com/goravel/framework/contracts/foundation"
  "github.com/goravel/framework/facades"

  "goravel/database/seeders"
)

type DatabaseServiceProvider struct {
}

func (receiver *DatabaseServiceProvider) Register(app foundation.Application) {

}

func (receiver *DatabaseServiceProvider) Boot(app foundation.Application) {
  facades.Seeder().Register([]seeder.Seeder{
    &seeders.DatabaseSeeder{},
  })
}
```

### 4. 注册新的 Provider

```go
// config/app.go
"providers": []foundation.ServiceProvider{
  ……
  &providers.DatabaseServiceProvider{},
}
```

### 5. 修改 facades.Cache() 中 Remember 与 RememberForever 方法（如果用到）

```go
// 修改前
Remember(key string, ttl time.Duration, callback func() any) (any, error)
RememberForever(key string, callback func() any) (any, error)

// 修改后
Remember(key string, ttl time.Duration, callback func() (any, error)) (any, error)
RememberForever(key string, callback func() (any, error)) (any, error)
```

## 功能介绍

### 数据填充

Version: v1.13.0

[查看文档](../orm/seeding.md)

### 修复 facades.Auth().User() 的问题

Version: v1.13.0

修复使用 `facades.Auth().User(ctx, &user)` 方法时，如果 user 不存在不抛出错误的问题。

### 修复 facades.Orm().Query().Load() 的问题

Version: v1.13.0

修复 `facades.Orm().Query().Load()` 某种情况下无法正确加载模型的问题。
