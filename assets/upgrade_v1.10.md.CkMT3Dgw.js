import{_ as a,f as t,o as i,an as r}from"./chunks/framework.CFMQV-X7.js";const u=JSON.parse('{"title":"Upgrading To v1.10 From v1.9","description":"","frontmatter":{},"headers":[],"relativePath":"upgrade/v1.10.md","filePath":"en/upgrade/v1.10.md","lastUpdated":1761815875000}'),o={name:"upgrade/v1.10.md"};function s(d,e,n,l,h,p){return i(),t("div",null,e[0]||(e[0]=[r(`<h1 id="upgrading-to-v1-10-from-v1-9" tabindex="-1">Upgrading To v1.10 From v1.9 <a class="header-anchor" href="#upgrading-to-v1-10-from-v1-9" aria-label="Permalink to “Upgrading To v1.10 From v1.9”">​</a></h1><nav class="table-of-contents"><ul><li><a href="#exciting-new-features-🎉">Exciting New Features 🎉</a></li><li><a href="#enhancements-🚀">Enhancements 🚀</a></li><li><a href="#breaking-changes-🛠">Breaking Changes 🛠</a></li><li><a href="#upgrade-guide">Upgrade Guide</a><ul><li><a href="#updating-dependencies">Updating Dependencies</a></li><li><a href="#encryption">Encryption</a></li><li><a href="#hashing">Hashing</a></li><li><a href="#add-rate-limiting-for-routing">Add Rate Limiting For Routing</a></li><li><a href="#optimize-http-startup-mode">Optimize HTTP startup mode</a></li><li><a href="#optimize-grpc-startup-mode">Optimize GRPC startup mode</a></li><li><a href="#add-configuration-to-control-log-output-to-console">Add configuration to control log output to console</a></li><li><a href="#request-modify-and-add-methods">Request modify and add methods</a></li><li><a href="#queue-support-delayed-dispatching">Queue support delayed dispatching</a></li><li><a href="#the-connection-in-orm-supports-set-table-prefix-and-singular">The Connection in ORM supports set table prefix and singular</a></li><li><a href="#add-docker-compose-yml-file">Add docker-compose.yml file</a></li><li><a href="#optimize-orm">Optimize Orm</a></li><li><a href="#support-multiple-sql-in-migration-file">Support multiple SQL in migration file</a></li><li><a href="#add-minio-driver-for-file-storage">Add minio driver for File Storage</a></li><li><a href="#contracts-http-add-status-mapping-of-net-http">contracts/http add status mapping of net/http</a></li><li><a href="#app-key-required">APP_KEY required</a></li><li><a href="#add-ctx-parameter-to-the-methods-under-form-request">Add ctx parameter to the methods under Form Request</a></li><li><a href="#facades-auth-parse-add-payload-returns">facades.Auth.Parse add payload returns</a></li><li><a href="#some-methods-of-orm-add-new-return-values">Some methods of Orm add new return values</a></li></ul></li></ul></nav><h2 id="exciting-new-features-🎉" tabindex="-1">Exciting New Features 🎉 <a class="header-anchor" href="#exciting-new-features-🎉" aria-label="Permalink to “Exciting New Features 🎉”">​</a></h2><ul><li><a href="#encryption">Add facades.Crypt(1.10.0)</a></li><li><a href="#hashing">Add facades.Hash(1.10.0)</a></li><li><a href="#add-rate-limiting-for-routing">Add Rate Limiting For Routing(1.10.0)</a></li></ul><h2 id="enhancements-🚀" tabindex="-1">Enhancements 🚀 <a class="header-anchor" href="#enhancements-🚀" aria-label="Permalink to “Enhancements 🚀”">​</a></h2><ul><li><a href="#optimize-http-startup-mode">Optimize HTTP startup mode(1.10.0)</a></li><li><a href="#optimize-grpc-startup-mode">Optimize GRPC startup mode(1.10.0)</a></li><li><a href="#add-configuration-to-control-log-output-to-console">Add configuration to control log output to console(1.10.0)</a></li><li><a href="#request-modify-and-add-methods">Request modify and add methods(1.10.0)</a></li><li><a href="#queue-support-delayed-dispatching">Queue support delayed dispatching(1.10.0)</a></li><li><a href="#the-connection-in-orm-supports-set-table-prefix-and-singular">The Connection in ORM supports set table prefix and singular(1.10.0)</a></li><li><a href="#add-docker-compose-yml-file">Add docker-compose.yml file(1.10.0)</a></li><li><a href="#optimize-orm">Optimize Orm(1.10.0)</a></li><li><a href="#support-multiple-sql-in-migration-file">Support multiple SQL in migration file(1.10.0)</a></li><li><a href="#add-minio-driver-for-file-storage">Add minio driver for File Storage(1.10.0)</a></li><li><a href="#contracts-http-add-status-mapping-of-net-http">contracts/http add status mapping of net/http(1.10.0)</a></li></ul><h2 id="breaking-changes-🛠" tabindex="-1">Breaking Changes 🛠 <a class="header-anchor" href="#breaking-changes-🛠" aria-label="Permalink to “Breaking Changes 🛠”">​</a></h2><ul><li><a href="#app-key-required">APP_KEY required(1.10.0)</a></li><li><a href="#add-ctx-parameter-to-the-methods-under-form-request">Add ctx parameter to the methods under Form Request(1.10.0)</a></li><li><a href="#facades-auth-parse-add-payload-returns">facades.Auth.Parse adds payload returns(1.10.0)</a></li><li><a href="#some-methods-of-orm-add-new-return-values">Some methods of Orm add new return values(1.10.0)</a></li></ul><h2 id="upgrade-guide" tabindex="-1">Upgrade Guide <a class="header-anchor" href="#upgrade-guide" aria-label="Permalink to “Upgrade Guide”">​</a></h2><p><strong>Estimated Upgrade Time: 20 Minutes</strong></p><h3 id="updating-dependencies" tabindex="-1">Updating Dependencies <a class="header-anchor" href="#updating-dependencies" aria-label="Permalink to “Updating Dependencies”">​</a></h3><p>Update dependencies in the <code>go.mod</code> file:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>go get -u github.com/goravel/framework@v1.10.0 &amp;&amp; go mod tidy</span></span></code></pre></div><h3 id="encryption" tabindex="-1">Encryption <a class="header-anchor" href="#encryption" aria-label="Permalink to “Encryption”">​</a></h3><p>Version: v1.10.0</p><p>Add <code>facades.Crypt</code>:</p><ol><li>add <code>&amp;crypt.ServiceProvider{}</code> to the <code>providers</code> item in the <a href="https://github.com/goravel/goravel/blob/v1.10.x/config/app.go" target="_blank" rel="noreferrer">config/app.go</a> file;</li></ol><p><a href="./../security/encryption.html">For Detail</a></p><h3 id="hashing" tabindex="-1">Hashing <a class="header-anchor" href="#hashing" aria-label="Permalink to “Hashing”">​</a></h3><p>Version: v1.10.0</p><p>Add <code>facades.Hash</code>:</p><ol><li><p>add <code>&amp;hash.ServiceProvider{}</code> to the <code>providers</code> item in the <a href="https://github.com/goravel/goravel/blob/v1.10.x/config/app.go" target="_blank" rel="noreferrer">config/app.go</a> file;</p></li><li><p>Add <a href="https://github.com/goravel/goravel/blob/v1.10.x/config/hashing.go" target="_blank" rel="noreferrer">config/hashing.go</a> file;</p></li></ol><p><a href="./../security/hashing.html">For Detail</a></p><h3 id="add-rate-limiting-for-routing" tabindex="-1">Add Rate Limiting For Routing <a class="header-anchor" href="#add-rate-limiting-for-routing" aria-label="Permalink to “Add Rate Limiting For Routing”">​</a></h3><p>Version: v1.10.0</p><p><a href="./../the-basics/routing.html#Rate-Limiting">For Detail</a></p><h3 id="optimize-http-startup-mode" tabindex="-1">Optimize HTTP startup mode <a class="header-anchor" href="#optimize-http-startup-mode" aria-label="Permalink to “Optimize HTTP startup mode”">​</a></h3><p>Version: v1.10.0</p><ol><li>Add <code>config/http.go</code> configuration, <a href="https://github.com/goravel/goravel/blob/v1.10.x/config/http.go" target="_blank" rel="noreferrer">For Detail</a>;</li><li>The <code>facades.Route.Run</code> method no longer needs to pass parameters, by default use <code>http.host</code> and <code>http.port</code>(you don&#39;t need to modify the code, it&#39;s backward compatible);</li><li>The <code>facades.Route.RunTLS</code> method no longer needs to pass parameters, by default use <code>http.tls.host</code>, <code>http.tls.port</code>, <code>http.tls.ssl.cert</code> and <code>http.tls.ssl.key</code>, if you are using it, you need to modify the code;</li><li>Add <code>facades.Route.RunTLSWithCert</code> method, <a href="./../the-basics/routing.html#start-server">For Detail</a>;</li><li>Move <code>app.url</code>, <code>app.host</code> to <code>http.url</code>, <code>http.host</code>;</li></ol><h3 id="optimize-grpc-startup-mode" tabindex="-1">Optimize GRPC startup mode <a class="header-anchor" href="#optimize-grpc-startup-mode" aria-label="Permalink to “Optimize GRPC startup mode”">​</a></h3><p>Version: v1.10.0</p><p>The <code>facades.Grpc.Run</code> method no longer needs to pass parameters, by default use <code>grpc.host</code> and <code>grpc.port</code>(you don&#39;t need to modify the code, it&#39;s backward compatible);</p><h3 id="add-configuration-to-control-log-output-to-console" tabindex="-1">Add configuration to control log output to console <a class="header-anchor" href="#add-configuration-to-control-log-output-to-console" aria-label="Permalink to “Add configuration to control log output to console”">​</a></h3><p>Version: v1.10.0</p><p>Add <code>print</code> configuration to <code>single</code>, <code>daily</code> channel in the <code>config/logging.go</code> file, it can control log output to console, <a href="https://github.com/goravel/goravel/blob/v1.10.x/config/logging.go" target="_blank" rel="noreferrer">For Detail</a>;</p><h3 id="request-modify-and-add-methods" tabindex="-1">Request modify and add methods <a class="header-anchor" href="#request-modify-and-add-methods" aria-label="Permalink to “Request modify and add methods”">​</a></h3><p>Version: v1.10.0</p><ol><li>The <code>Input</code> method is changed from only getting routing parameters to getting data according to the following order: <code>json</code>, <code>form</code>, <code>query</code>, <code>route</code>。Note: <code>json</code> can only get one-dimensional data, otherwise it will return empty;</li><li>Add <code>Route</code> method to replace the original <code>Input</code> method;</li><li>The default value of <code>Query</code> and <code>Form</code> methods are modified to be unnecessary;</li><li>Add methods as shown below:</li></ol><table tabindex="0"><thead><tr><th>Method</th><th>Action</th></tr></thead><tbody><tr><td>Route</td><td><a href="./../the-basics/request.html#Retrieving-An-Input-Value">Retrieving An Route Value</a></td></tr><tr><td>RouteInt</td><td><a href="./../the-basics/request.html#Retrieving-An-Input-Value">Retrieving An Route Value</a></td></tr><tr><td>RouteInt64</td><td><a href="./../the-basics/request.html#Retrieving-An-Input-Value">Retrieving An Route Value</a></td></tr><tr><td>QueryInt</td><td><a href="./../the-basics/request.html#Retrieving-Input-From-The-Query-String">Retrieving Input From The Query String</a></td></tr><tr><td>QueryInt64</td><td><a href="./../the-basics/request.html#Retrieving-Input-From-The-Query-String">Retrieving Input From The Query String</a></td></tr><tr><td>QueryBool</td><td><a href="./../the-basics/request.html#Retrieving-Input-From-The-Query-String">Retrieving Input From The Query String</a></td></tr><tr><td>InputInt</td><td><a href="./../the-basics/request.html#Retrieving-An-Input-Value">Retrieving An Input Value</a></td></tr><tr><td>InputInt64</td><td><a href="./../the-basics/request.html#Retrieving-An-Input-Value">Retrieving An Input Value</a></td></tr><tr><td>InputBool</td><td><a href="./../the-basics/request.html#Retrieving-An-Input-Value">Retrieving An Input Value</a></td></tr><tr><td>Json</td><td><a href="./../the-basics/request.html#Retrieving-Json">Retrieving Json</a></td></tr></tbody></table><h3 id="queue-support-delayed-dispatching" tabindex="-1">Queue support delayed dispatching <a class="header-anchor" href="#queue-support-delayed-dispatching" aria-label="Permalink to “Queue support delayed dispatching”">​</a></h3><p>Version: v1.10.0</p><p>Add <code>Delay</code> method, <a href="./../digging-deeper/queues.html#Delayed-Dispatching">For Detail</a></p><h3 id="the-connection-in-orm-supports-set-table-prefix-and-singular" tabindex="-1">The Connection in ORM supports set table prefix and singular <a class="header-anchor" href="#the-connection-in-orm-supports-set-table-prefix-and-singular" aria-label="Permalink to “The Connection in ORM supports set table prefix and singular”">​</a></h3><p>Version: v1.10.0</p><ol><li><code>Model</code> supports specify table name, <a href="./../orm/getting-started.html#指定表名">For Detail</a>;</li><li>Add new keys to <code>connection</code> of <code>config/database.go</code>:</li></ol><p><code>prefix</code>: Set prefix for table name; <code>singular</code>: Set the table name to use singular or plural;</p><p><a href="https://github.com/goravel/goravel/blob/v1.10.x/config/database.go" target="_blank" rel="noreferrer">For Detail</a></p><h3 id="add-docker-compose-yml-file" tabindex="-1">Add docker-compose.yml file <a class="header-anchor" href="#add-docker-compose-yml-file" aria-label="Permalink to “Add docker-compose.yml file”">​</a></h3><p>Version: v1.10.0</p><p>You can quickly start the service with the following command:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>docker-compose build</span></span>
<span class="line"><span>docker-compose up</span></span></code></pre></div><h3 id="optimize-orm" tabindex="-1">Optimize Orm <a class="header-anchor" href="#optimize-orm" aria-label="Permalink to “Optimize Orm”">​</a></h3><p>Version: v1.10.0</p><ol><li>Add the following methods:</li></ol><table tabindex="0"><thead><tr><th>Functions</th><th>Action</th></tr></thead><tbody><tr><td>FirstOr</td><td><a href="#Query-one-line">Query or return data through callback</a></td></tr><tr><td>FirstOrNew</td><td><a href="#Retrieving-Or-Creating-Models">Retrieving Or New Models</a></td></tr><tr><td>FirstOrFail</td><td><a href="#Not-Found-Error">Not Found Error</a></td></tr><tr><td>UpdateOrCreate</td><td><a href="#Update-or-create">Update or create</a></td></tr></tbody></table><ol start="2"><li>An error was reported like this before, but now it&#39;s supported:</li></ol><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> facades.Orm.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><h3 id="support-multiple-sql-in-migration-file" tabindex="-1">Support multiple SQL in migration file <a class="header-anchor" href="#support-multiple-sql-in-migration-file" aria-label="Permalink to “Support multiple SQL in migration file”">​</a></h3><p>Version: v1.10.0</p><p>Previously, only one SQL statement was supported in the migration file, but now multiple statements are supported.</p><h3 id="add-minio-driver-for-file-storage" tabindex="-1">Add minio driver for File Storage <a class="header-anchor" href="#add-minio-driver-for-file-storage" aria-label="Permalink to “Add minio driver for File Storage”">​</a></h3><p>Version: v1.10.0</p><p>Add minio configuration, <a href="https://github.com/goravel/goravel/blob/v1.10.x/config/filesystems.go" target="_blank" rel="noreferrer">For Detail</a>.</p><h3 id="contracts-http-add-status-mapping-of-net-http" tabindex="-1">contracts/http add status mapping of net/http <a class="header-anchor" href="#contracts-http-add-status-mapping-of-net-http" aria-label="Permalink to “contracts/http add status mapping of net/http”">​</a></h3><p>Version: v1.10.0</p><p>You can use status codes such as <code>http.StatusOK</code> directly in controller without importing <code>net/http</code>.</p><p><a href="https://github.com/goravel/framework/blob/v1.10.0/contracts/http/status.go" target="_blank" rel="noreferrer">For Detail</a></p><h3 id="app-key-required" tabindex="-1">APP_KEY required <a class="header-anchor" href="#app-key-required" aria-label="Permalink to “APP_KEY required”">​</a></h3><p>Version: v1.10.0</p><p>The <code>APP_KEY</code> in the <code>.env</code> file is changed to required, you can run command to generate the APP_KEY: <code>go run . artisan key:generate</code>.</p><h3 id="add-ctx-parameter-to-the-methods-under-form-request" tabindex="-1">Add ctx parameter to the methods under Form Request <a class="header-anchor" href="#add-ctx-parameter-to-the-methods-under-form-request" aria-label="Permalink to “Add ctx parameter to the methods under Form Request”">​</a></h3><p>Version: v1.10.0</p><p>Add <code>ctx http.Context</code> parameter to the methods under Form Request: <code>Rules</code>, <code>Messages</code>, <code>Attributes</code>, <code>PrepareForValidation</code>, allows you to do more custom configurations.</p><p><a href="./../the-basics/validation.html#creating-form-requests">For Detail</a></p><h3 id="facades-auth-parse-add-payload-returns" tabindex="-1">facades.Auth.Parse add payload returns <a class="header-anchor" href="#facades-auth-parse-add-payload-returns" aria-label="Permalink to “facades.Auth.Parse add payload returns”">​</a></h3><p>Version: v1.10.0</p><p><code>err := facades.Auth.Parse(ctx, token)</code> change to <code>payload, err := facades.Auth.Parse(ctx, token)</code>, through <code>payload</code> you can get:</p><ol><li><code>Guard</code>: Current Guard;</li><li><code>Key</code>: User flag;</li><li><code>ExpireAt</code>: Expire time;</li><li><code>IssuedAt</code>: Issued time;</li></ol><p><a href="./../security/authentication.html#parse-token">For Detail</a></p><h3 id="some-methods-of-orm-add-new-return-values" tabindex="-1">Some methods of Orm add new return values <a class="header-anchor" href="#some-methods-of-orm-add-new-return-values" aria-label="Permalink to “Some methods of Orm add new return values”">​</a></h3><p>Version: v1.10.0</p><p>The following methods add <code>*Result</code> return value to get the number of affected rows:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Exec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Sprintf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DELETE FROM users where id = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, user.ID))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ForceDelete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Updates</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{Avatar: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;avatar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Affected rows</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> res.RowsAffected</span></span></code></pre></div>`,83)]))}const g=a(o,[["render",s]]);export{u as __pageData,g as default};
