import{_ as s,f as i,o as e,an as t}from"./chunks/framework.CFMQV-X7.js";const c=JSON.parse('{"title":"从 v1.11 升级到 v1.12","description":"","frontmatter":{},"headers":[],"relativePath":"zh_CN/upgrade/v1.12.md","filePath":"zh_CN/upgrade/v1.12.md","lastUpdated":1761815875000}'),h={name:"zh_CN/upgrade/v1.12.md"};function n(l,a,d,r,p,k){return e(),i("div",null,a[0]||(a[0]=[t(`<h1 id="从-v1-11-升级到-v1-12" tabindex="-1">从 v1.11 升级到 v1.12 <a class="header-anchor" href="#从-v1-11-升级到-v1-12" aria-label="Permalink to “从 v1.11 升级到 v1.12”">​</a></h1><h2 id="v1-12-6" tabindex="-1">v1.12.6 <a class="header-anchor" href="#v1-12-6" aria-label="Permalink to “v1.12.6”">​</a></h2><h3 id="bug-修复-🐛" tabindex="-1">Bug 修复 🐛 <a class="header-anchor" href="#bug-修复-🐛" aria-label="Permalink to “Bug 修复 🐛”">​</a></h3><ul><li><a href="#修复-jwt-的问题">修复 JWT 的问题</a></li></ul><h2 id="v1-12-5" tabindex="-1">v1.12.5 <a class="header-anchor" href="#v1-12-5" aria-label="Permalink to “v1.12.5”">​</a></h2><h3 id="bug-修复-🐛-1" tabindex="-1">Bug 修复 🐛 <a class="header-anchor" href="#bug-修复-🐛-1" aria-label="Permalink to “Bug 修复 🐛”">​</a></h3><ul><li><a href="#修复-facades-orm-query-load-的问题">修复 facades.Orm().Query().Load() 的问题</a></li></ul><h2 id="v1-12-4" tabindex="-1">v1.12.4 <a class="header-anchor" href="#v1-12-4" aria-label="Permalink to “v1.12.4”">​</a></h2><h3 id="bug-修复-🐛-2" tabindex="-1">Bug 修复 🐛 <a class="header-anchor" href="#bug-修复-🐛-2" aria-label="Permalink to “Bug 修复 🐛”">​</a></h3><ul><li><a href="#throttle-中间件-panic-的问题">throttle 中间件 panic 的问题</a></li></ul><h2 id="v1-12-3" tabindex="-1">v1.12.3 <a class="header-anchor" href="#v1-12-3" aria-label="Permalink to “v1.12.3”">​</a></h2><h3 id="bug-修复-🐛-3" tabindex="-1">Bug 修复 🐛 <a class="header-anchor" href="#bug-修复-🐛-3" aria-label="Permalink to “Bug 修复 🐛”">​</a></h3><ul><li><a href="#windows-下-make-package-命令的问题">Windows 下 make:package 命令的问题</a></li></ul><h2 id="v1-12-2" tabindex="-1">v1.12.2 <a class="header-anchor" href="#v1-12-2" aria-label="Permalink to “v1.12.2”">​</a></h2><h3 id="bug-修复-🐛-4" tabindex="-1">Bug 修复 🐛 <a class="header-anchor" href="#bug-修复-🐛-4" aria-label="Permalink to “Bug 修复 🐛”">​</a></h3><ul><li><a href="#facades-gate-返回-nil-的问题">facades.Gate() 返回 nil 的问题</a></li></ul><h2 id="v1-12-1" tabindex="-1">v1.12.1 <a class="header-anchor" href="#v1-12-1" aria-label="Permalink to “v1.12.1”">​</a></h2><h3 id="bug-修复-🐛-5" tabindex="-1">Bug 修复 🐛 <a class="header-anchor" href="#bug-修复-🐛-5" aria-label="Permalink to “Bug 修复 🐛”">​</a></h3><ul><li><a href="#windows-下因文件路径引发-panic-的问题">Windows 下因文件路径引发 panic 的问题</a></li></ul><h2 id="v1-12-0" tabindex="-1">v1.12.0 <a class="header-anchor" href="#v1-12-0" aria-label="Permalink to “v1.12.0”">​</a></h2><h3 id="令人兴奋的新功能-🎉" tabindex="-1">令人兴奋的新功能 🎉 <a class="header-anchor" href="#令人兴奋的新功能-🎉" aria-label="Permalink to “令人兴奋的新功能 🎉”">​</a></h3><ul><li><a href="#服务容器">服务容器</a></li><li><a href="#扩展包开发">扩展包开发</a></li><li><a href="#新增-helpers-方法">新增 Carbon 模块</a></li></ul><h2 id="功能增强-🚀" tabindex="-1">功能增强 🚀 <a class="header-anchor" href="#功能增强-🚀" aria-label="Permalink to “功能增强 🚀”">​</a></h2><ul><li><a href="#artisan-flag-新增方法">Artisan Flag 新增方法</a></li><li><a href="#新增-helpers-方法">新增 Helpers 方法</a></li><li><a href="#升级依赖">升级依赖</a></li><li><a href="#migration-新增命令">Migration 新增命令</a></li><li><a href="#部分-make-命令支持子文件夹">部分 <code>make</code> 命令支持子文件夹</a></li></ul><h2 id="破坏性变化-🛠" tabindex="-1">破坏性变化 🛠 <a class="header-anchor" href="#破坏性变化-🛠" aria-label="Permalink to “破坏性变化 🛠”">​</a></h2><ul><li><a href="#_3-修改-facades">修改 facades 调用方式</a></li><li><a href="#_6-修改-artisan-命令中的-flag-如果用到">优化 Artisan Flag 参数格式</a></li><li><a href="#_7-filesystem-模块取消对-s3-oss-cos-minio-驱动的默认支持">Filesystem 模块取消对 S3, OSS, COS, Minio 驱动的默认支持</a></li><li><a href="#_8-cache-模块取消对-redis-驱动的默认支持">Cache 模块取消对 Redis 驱动的默认支持</a></li><li><a href="#_9-修改-model-中-createdat-updatedat-的类型">修改 Model 中 CreatedAt, UpdatedAt 的类型</a></li><li><a href="#_10-优化-validation-模块的校验规则">优化 Validation 模块的校验规则</a></li></ul><h2 id="升级指南" tabindex="-1">升级指南 <a class="header-anchor" href="#升级指南" aria-label="Permalink to “升级指南”">​</a></h2><p>请根据本节内容，一步步进行框架升级。</p><p><strong>预计升级时间：30 分钟</strong></p><h3 id="_1-更新依赖" tabindex="-1">1. 更新依赖 <a class="header-anchor" href="#_1-更新依赖" aria-label="Permalink to “1. 更新依赖”">​</a></h3><p><code>go.mod</code> 中更新依赖：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>go get -u github.com/goravel/framework@v1.12.0 &amp;&amp; go mod tidy</span></span></code></pre></div><p><code>go mod tidy</code> 将会抛出一个错误，执行完下面升级步骤即可解决。</p><h3 id="_2-修改-bootstrap-app-go" tabindex="-1">2. 修改 <code>bootstrap/app.go</code> <a class="header-anchor" href="#_2-修改-bootstrap-app-go" aria-label="Permalink to “2. 修改 bootstrap/app.go”">​</a></h3><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 修改前</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> foundation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Application</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 修改后</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> foundation.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NewApplication</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><h3 id="_3-修改-facades" tabindex="-1">3. 修改 facades.* <a class="header-anchor" href="#_3-修改-facades" aria-label="Permalink to “3. 修改 facades.*”">​</a></h3><table tabindex="0"><thead><tr><th>修改前</th><th>修改后</th></tr></thead><tbody><tr><td><code>facades.Artisan</code></td><td><code>facades.Artisan()</code></td></tr><tr><td><code>facades.Auth</code></td><td><code>facades.Auth()</code></td></tr><tr><td><code>facades.Cache</code></td><td><code>facades.Cache()</code></td></tr><tr><td><code>facades.Config</code></td><td><code>facades.Config()</code></td></tr><tr><td><code>facades.Crypt</code></td><td><code>facades.Crypt()</code></td></tr><tr><td><code>facades.Event</code></td><td><code>facades.Event()</code></td></tr><tr><td><code>facades.Gate</code></td><td><code>facades.Gate()</code></td></tr><tr><td><code>facades.Grpc</code></td><td><code>facades.Grpc()</code></td></tr><tr><td><code>facades.Hash</code></td><td><code>facades.Hash()</code></td></tr><tr><td><code>facades.Log</code></td><td><code>facades.Log()</code></td></tr><tr><td><code>facades.Mail</code></td><td><code>facades.Mail()</code></td></tr><tr><td><code>facades.Orm</code></td><td><code>facades.Orm()</code></td></tr><tr><td><code>facades.Queue</code></td><td><code>facades.Queue()</code></td></tr><tr><td><code>facades.RateLimiter</code></td><td><code>facades.RateLimiter()</code></td></tr><tr><td><code>facades.Route</code></td><td><code>facades.Route()</code></td></tr><tr><td><code>facades.Schedule</code></td><td><code>facades.Schedule()</code></td></tr><tr><td><code>facades.Storage</code></td><td><code>facades.Storage()</code></td></tr><tr><td><code>facades.Validation</code></td><td><code>facades.Validation()</code></td></tr></tbody></table><h3 id="_4-修改-app-providers" tabindex="-1">4. 修改 <code>app/providers/*</code> <a class="header-anchor" href="#_4-修改-app-providers" aria-label="Permalink to “4. 修改 app/providers/*”">​</a></h3><p>所有文件增加导入：</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">github.com/goravel/framework/contracts/foundation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>所有 <code>Register</code>, <code>Boot</code> 方法增加 <code>app foundation.Application</code> 入参：</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">receiver </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AppServiceProvider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">app</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> foundation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Application</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">receiver </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AppServiceProvider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Boot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">app</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> foundation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Application</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {}</span></span></code></pre></div><h3 id="_5-修改-app-config-app-go" tabindex="-1">5. 修改 <code>app/config/app.go</code> <a class="header-anchor" href="#_5-修改-app-config-app-go" aria-label="Permalink to “5. 修改 app/config/app.go”">​</a></h3><p>修改导入：</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 修改前</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;github.com/goravel/framework/contracts&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;providers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">contracts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ServiceProvider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 修改后</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;github.com/goravel/framework/contracts/foundation&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;providers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">foundation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ServiceProvider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span></code></pre></div><h3 id="_6-修改-artisan-命令中的-flag-如果用到" tabindex="-1">6. 修改 Artisan 命令中的 Flag（如果用到） <a class="header-anchor" href="#_6-修改-artisan-命令中的-flag-如果用到" aria-label="Permalink to “6. 修改 Artisan 命令中的 Flag（如果用到）”">​</a></h3><p>为 <code>[]command.Flag</code> 中的项增加 <code>&amp;command.StringFlag</code> 类型：</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 修改前</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">receiver </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VendorPublishCommand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Category: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Flags: []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Flag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 修改后</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">receiver </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VendorPublishCommand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Category: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Flags: []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Flag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">StringFlag</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_7-filesystem-模块取消对-s3-oss-cos-minio-驱动的默认支持" tabindex="-1">7. Filesystem 模块取消对 S3, OSS, COS, Minio 驱动的默认支持 <a class="header-anchor" href="#_7-filesystem-模块取消对-s3-oss-cos-minio-驱动的默认支持" aria-label="Permalink to “7. Filesystem 模块取消对 S3, OSS, COS, Minio 驱动的默认支持”">​</a></h3><p>为减少加载不必要的第三方包，减小打包体积，提高编译效率，Goravel 将逐步剥离各模块驱动到独立扩展包。 本次升级 Filesystem 模块取消对 <code>S3</code>, <code>OSS</code>, <code>COS</code>, <code>Minio</code> 驱动的默认支持，转由独立扩展包提供支持。</p><p>删除 <code>config/filesystems.go::disks</code> 中除 <code>local</code> 和正在使用的驱动以外的键：</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 修改后</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;disks&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;local&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;driver&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;local&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;root&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;storage/app&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:    config.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;APP_URL&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/storage&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span></code></pre></div><p>如果你用到了 <code>local</code> 以外的驱动，请参考对应驱动文档进行安装：</p><table tabindex="0"><thead><tr><th>驱动</th><th>链接</th></tr></thead><tbody><tr><td>S3</td><td><a href="https://github.com/goravel/s3" target="_blank" rel="noreferrer">https://github.com/goravel/s3</a></td></tr><tr><td>OSS</td><td><a href="https://github.com/goravel/oss" target="_blank" rel="noreferrer">https://github.com/goravel/oss</a></td></tr><tr><td>COS</td><td><a href="https://github.com/goravel/cos" target="_blank" rel="noreferrer">https://github.com/goravel/cos</a></td></tr><tr><td>Minio</td><td><a href="https://github.com/goravel/minio" target="_blank" rel="noreferrer">https://github.com/goravel/minio</a></td></tr></tbody></table><h3 id="_8-cache-模块取消对-redis-驱动的默认支持" tabindex="-1">8. Cache 模块取消对 Redis 驱动的默认支持 <a class="header-anchor" href="#_8-cache-模块取消对-redis-驱动的默认支持" aria-label="Permalink to “8. Cache 模块取消对 Redis 驱动的默认支持”">​</a></h3><p>如果你没有使用 <code>redis</code> 驱动，删除 <code>config/cache.go::stores</code> 中的 <code>redis</code> 键：</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 修改后</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;stores&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;memory&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;driver&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;memory&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span></code></pre></div><p>如果你用到了 <code>redis</code> 驱动，请参考文档进行安装：</p><table tabindex="0"><thead><tr><th>驱动</th><th>链接</th></tr></thead><tbody><tr><td>Redis</td><td><a href="https://github.com/goravel/redis" target="_blank" rel="noreferrer">https://github.com/goravel/redis</a></td></tr></tbody></table><h3 id="_9-修改-model-中-createdat-updatedat-的类型" tabindex="-1">9. 修改 Model 中 CreatedAt, UpdatedAt 的类型 <a class="header-anchor" href="#_9-修改-model-中-createdat-updatedat-的类型" aria-label="Permalink to “9. 修改 Model 中 CreatedAt, UpdatedAt 的类型”">​</a></h3><p>为了使时间类型在接口输出时更加标准，<code>CreatedAt</code>, <code>UpdatedAt</code> 类型由 <code>time.Time</code> 修改为 <code>carbon.DateTime</code>。 如果你对这两个字段进行了额外处理，可以通过 <code>CreatedAt.ToStdTime()</code> 方法获取原有的 <code>time.Time</code> 类型。</p><h3 id="_10-优化-validation-模块的校验规则" tabindex="-1">10. 优化 Validation 模块的校验规则 <a class="header-anchor" href="#_10-优化-validation-模块的校验规则" aria-label="Permalink to “10. 优化 Validation 模块的校验规则”">​</a></h3><p>原有校验规则中对零值进行校验，例如设置规则为 <code>date</code> 且没有设置 <code>required</code>，如果该字段为空或未传入，会提示该字段必填。 优化后，将跳过校验，更符合使用直觉。 如果你用到了相关校验，请确保升级后与预期一致。</p><h3 id="_11-再次安装依赖" tabindex="-1">11. 再次安装依赖 <a class="header-anchor" href="#_11-再次安装依赖" aria-label="Permalink to “11. 再次安装依赖”">​</a></h3><p>运行 <code>go mod tidy</code> 命令。</p><h2 id="功能介绍" tabindex="-1">功能介绍 <a class="header-anchor" href="#功能介绍" aria-label="Permalink to “功能介绍”">​</a></h2><h3 id="服务容器" tabindex="-1">服务容器 <a class="header-anchor" href="#服务容器" aria-label="Permalink to “服务容器”">​</a></h3><p>Version: v1.12.0</p><p>Goravel 中所有服务都注册到服务容器当中，为第三方包的开发提供有力的支持，<a href="./../architecture-concepts/service-container.html">详见文档</a>。</p><h3 id="扩展包开发" tabindex="-1">扩展包开发 <a class="header-anchor" href="#扩展包开发" aria-label="Permalink to “扩展包开发”">​</a></h3><p>Version: v1.12.0</p><p>包是向 Goravel 添加功能的主要方式，可以使 Goravel 的生态更加丰富，<a href="./../digging-deeper/package-development.html">详见文档</a>。</p><h3 id="artisan-flag-新增方法" tabindex="-1">Artisan Flag 新增方法 <a class="header-anchor" href="#artisan-flag-新增方法" aria-label="Permalink to “Artisan Flag 新增方法”">​</a></h3><p>Version: v1.12.0</p><p>为 Artisan 模块新增获取不同类型 <code>Flag</code> 的方法，<a href="./../digging-deeper/artisan-console.html#选项">详见文档</a>。</p><h3 id="新增-helpers-方法" tabindex="-1">新增 Helpers 方法 <a class="header-anchor" href="#新增-helpers-方法" aria-label="Permalink to “新增 Helpers 方法”">​</a></h3><p>Version: v1.12.0</p><p>新增 <code>path</code>, <code>carbon</code> Helpers 方法，可以很方便的获取项目中的路径信息与进行时间处理，<a href="./../digging-deeper/helpers.html">详见文档</a>。</p><h3 id="升级依赖" tabindex="-1">升级依赖 <a class="header-anchor" href="#升级依赖" aria-label="Permalink to “升级依赖”">​</a></h3><p>Version: v1.12.0</p><p>为提供更好的功能支持，升级了 Goravel 依赖的所有包的版本。</p><h3 id="migration-新增命令" tabindex="-1">Migration 新增命令 <a class="header-anchor" href="#migration-新增命令" aria-label="Permalink to “Migration 新增命令”">​</a></h3><p>Version: v1.12.0</p><table tabindex="0"><thead><tr><th>命令</th><th>作用</th></tr></thead><tbody><tr><td>migrate:fresh</td><td>删除所有表并重新运行所有迁移</td></tr><tr><td>migrate:refresh</td><td>回滚所有迁移并重新运行所有迁移</td></tr><tr><td>migrate:reset</td><td>回滚所有迁移</td></tr><tr><td>migrate:status</td><td>查询迁移状态</td></tr></tbody></table><h3 id="部分-make-命令支持子文件夹" tabindex="-1">部分 <code>make</code> 命令支持子文件夹 <a class="header-anchor" href="#部分-make-命令支持子文件夹" aria-label="Permalink to “部分 make 命令支持子文件夹”">​</a></h3><p>Version: v1.12.0</p><table tabindex="0"><thead><tr><th>命令</th><th>生成文件</th></tr></thead><tbody><tr><td>make:policy User/AuthPolicy</td><td>app/policies/User/auth_policy.go</td></tr><tr><td>make:command Goravel/CleanCache</td><td>app/console/commands/Goravel/clean_cache.go</td></tr><tr><td>make:model User/Phone</td><td>app/models/User/phone.go</td></tr><tr><td>make:observer User/PhoneObserver</td><td>app/observers/User/phone_observer.go</td></tr><tr><td>make:event User/GoravelEvent</td><td>app/events/User/goravel_event.go</td></tr><tr><td>make:listener User/GoravelListen</td><td>app/listeners/User/goravel_listen.go</td></tr><tr><td>make:controller User/AuthController</td><td>app/http/controllers/User/auth_controller.go</td></tr><tr><td>make:middleware User/Auth</td><td>app/http/middleware/User/auth.go</td></tr><tr><td>make:request User/Auth</td><td>app/http/requests/User/auth.go</td></tr><tr><td>make:job Goravel/Job</td><td>app/jobs/Goravel/job.go</td></tr><tr><td>make:rule User/Phone</td><td>app/rules/User/phone.go</td></tr></tbody></table><h3 id="windows-下因文件路径引发-panic-的问题" tabindex="-1">Windows 下因文件路径引发 panic 的问题 <a class="header-anchor" href="#windows-下因文件路径引发-panic-的问题" aria-label="Permalink to “Windows 下因文件路径引发 panic 的问题”">​</a></h3><p>Version: v1.12.1</p><p>修复 windows 下，<code>make</code> 命令自动创建文件夹时，由于反斜杠引发 panic 的问题。</p><h3 id="facades-gate-返回-nil-的问题" tabindex="-1">facades.Gate() 返回 nil 的问题 <a class="header-anchor" href="#facades-gate-返回-nil-的问题" aria-label="Permalink to “facades.Gate() 返回 nil 的问题”">​</a></h3><p>Version: v1.12.2</p><p>修复 facades.Gate() 返回 nil 的问题。</p><h3 id="windows-下-make-package-命令的问题" tabindex="-1">Windows 下 make:package 命令的问题 <a class="header-anchor" href="#windows-下-make-package-命令的问题" aria-label="Permalink to “Windows 下 make:package 命令的问题”">​</a></h3><p>Version: v1.12.3</p><p>修复 Windows 下 make:package 命令创建的文件中的路径错误的问题。</p><h3 id="throttle-中间件-panic-的问题" tabindex="-1">throttle 中间件 panic 的问题 <a class="header-anchor" href="#throttle-中间件-panic-的问题" aria-label="Permalink to “throttle 中间件 panic 的问题”">​</a></h3><p>Version: v1.12.4</p><p>修复 throttle 中间件 panic 的问题。</p><h3 id="修复-facades-orm-query-load-的问题" tabindex="-1">修复 facades.Orm().Query().Load() 的问题 <a class="header-anchor" href="#修复-facades-orm-query-load-的问题" aria-label="Permalink to “修复 facades.Orm().Query().Load() 的问题”">​</a></h3><p>Version: v1.12.5</p><p>修复 <code>facades.Orm().Query().Load()</code> 某种情况下无法正确加载模型的问题。</p><h3 id="修复-jwt-的问题" tabindex="-1">修复 JWT 的问题 <a class="header-anchor" href="#修复-jwt-的问题" aria-label="Permalink to “修复 JWT 的问题”">​</a></h3><p>Version: v1.12.6</p><p>修复 JWT Token 过期且无效时，返回过期错误的问题，预期优先返回无效错误。</p>`,105)]))}const g=s(h,[["render",n]]);export{c as __pageData,g as default};
