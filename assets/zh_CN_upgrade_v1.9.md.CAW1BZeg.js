import{_ as e,f as i,o as s,an as r}from"./chunks/framework.CFMQV-X7.js";const k=JSON.parse('{"title":"从 v1.8 升级到 v1.9","description":"","frontmatter":{},"headers":[],"relativePath":"zh_CN/upgrade/v1.9.md","filePath":"zh_CN/upgrade/v1.9.md","lastUpdated":1761724533000}'),n={name:"zh_CN/upgrade/v1.9.md"};function l(t,a,o,h,p,d){return s(),i("div",null,a[0]||(a[0]=[r(`<h1 id="从-v1-8-升级到-v1-9" tabindex="-1">从 v1.8 升级到 v1.9 <a class="header-anchor" href="#从-v1-8-升级到-v1-9" aria-label="Permalink to “从 v1.8 升级到 v1.9”">​</a></h1><nav class="table-of-contents"><ul><li><a href="#功能增强-🚀">功能增强 🚀</a></li><li><a href="#破坏性变化-🛠">破坏性变化 🛠</a></li><li><a href="#bug-修复-🐛">Bug 修复 🐛</a></li><li><a href="#升级依赖-⬆️">升级依赖 ⬆️</a></li><li><a href="#升级指南">升级指南</a><ul><li><a href="#更新依赖">更新依赖</a></li><li><a href="#新增数据库读写分离">新增数据库读写分离</a></li><li><a href="#新增数据库连接池配置">新增数据库连接池配置</a></li><li><a href="#自定义-env-路径">自定义 .env 路径</a></li><li><a href="#cache-新增-memory-驱动">Cache 新增 Memory 驱动</a></li><li><a href="#orm-新增分页方法">Orm 新增分页方法</a></li><li><a href="#新增-make-命令">新增 make 命令</a></li><li><a href="#response-新增方法">Response 新增方法</a></li><li><a href="#request-prepareforvalidation-方法新增-error-返回">Request PrepareForValidation 方法新增 error 返回</a></li><li><a href="#file-获取错误的文件类型">File 获取错误的文件类型</a></li><li><a href="#修复-make-event-和-make-listener-命令生成模板有误的问题">修复 make:event 和 make:listener 命令生成模板有误的问题</a></li><li><a href="#修复保存文件时有些类型无法获取后缀的问题">修复保存文件时有些类型无法获取后缀的问题</a></li></ul></li></ul></nav><h2 id="功能增强-🚀" tabindex="-1">功能增强 🚀 <a class="header-anchor" href="#功能增强-🚀" aria-label="Permalink to “功能增强 🚀”">​</a></h2><ul><li><a href="#新增数据库读写分离">新增数据库读写分离(1.9.0)</a></li><li><a href="#新增数据库连接池配置">新增数据库连接池配置(1.9.0)</a></li><li><a href="#自定义-.env-路径">自定义 .env 路径(1.9.0)</a></li><li><a href="#cache-新增-memory-驱动">Cache 新增 Memory 驱动(1.9.0)</a></li><li><a href="#orm-新增分页方法">Orm 新增分页方法(1.9.0)</a></li><li><a href="#新增-make-命令">新增 make 命令(1.9.0)</a></li><li><a href="#response-新增方法">Response 新增方法(1.9.0)</a></li></ul><h2 id="破坏性变化-🛠" tabindex="-1">破坏性变化 🛠 <a class="header-anchor" href="#破坏性变化-🛠" aria-label="Permalink to “破坏性变化 🛠”">​</a></h2><ul><li><a href="#Request-PrepareForValidation-方法新增-error-返回">Request PrepareForValidation 方法新增 error 返回(1.9.0)</a></li></ul><h2 id="bug-修复-🐛" tabindex="-1">Bug 修复 🐛 <a class="header-anchor" href="#bug-修复-🐛" aria-label="Permalink to “Bug 修复 🐛”">​</a></h2><ul><li><a href="#File-获取错误的文件类型">File 获取错误的文件类型(1.9.0)</a></li><li><a href="#修复-make:event-和-make:listener-命令生成模板有误的问题">修复 make:event 和 make:listener 命令生成模板有误的问题(1.9.0)</a></li><li><a href="#修复保存文件时有些类型无法获取后缀的问题">修复保存文件时有些类型无法获取后缀的问题(1.9.1)</a></li></ul><h2 id="升级依赖-⬆️" tabindex="-1">升级依赖 ⬆️ <a class="header-anchor" href="#升级依赖-⬆️" aria-label="Permalink to “升级依赖 ⬆️”">​</a></h2><ul><li>build(deps): bump github.com/gin-gonic/gin from v1.7.3 to v1.8.2</li></ul><h2 id="升级指南" tabindex="-1">升级指南 <a class="header-anchor" href="#升级指南" aria-label="Permalink to “升级指南”">​</a></h2><p><strong>预计升级时间：10 分钟</strong></p><h3 id="更新依赖" tabindex="-1">更新依赖 <a class="header-anchor" href="#更新依赖" aria-label="Permalink to “更新依赖”">​</a></h3><p><code>go.mod</code> 中更新依赖：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>go get -u github.com/goravel/framework@v1.9.0</span></span></code></pre></div><h3 id="新增数据库读写分离" tabindex="-1">新增数据库读写分离 <a class="header-anchor" href="#新增数据库读写分离" aria-label="Permalink to “新增数据库读写分离”">​</a></h3><p>Version: v1.9.0</p><p>数据库支持读写分离配置，<a href="./../orm/getting-started.html#读写分离">详见文档</a>。</p><h3 id="新增数据库连接池配置" tabindex="-1">新增数据库连接池配置 <a class="header-anchor" href="#新增数据库连接池配置" aria-label="Permalink to “新增数据库连接池配置”">​</a></h3><p>Version: v1.9.0</p><p>数据库配置文件 <code>config/database.go</code> 新增连接池配置 <code>pool</code>，<a href="https://github.com/goravel/goravel/blob/v1.9.x/config/database.go" target="_blank" rel="noreferrer">详见文件</a>。</p><h3 id="自定义-env-路径" tabindex="-1">自定义 .env 路径 <a class="header-anchor" href="#自定义-env-路径" aria-label="Permalink to “自定义 .env 路径”">​</a></h3><p>Version: v1.9.0</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>// 编译前</span></span>
<span class="line"><span>go run . --env=../.env</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//编译后</span></span>
<span class="line"><span>./main --env=../.env</span></span></code></pre></div><h3 id="cache-新增-memory-驱动" tabindex="-1">Cache 新增 Memory 驱动 <a class="header-anchor" href="#cache-新增-memory-驱动" aria-label="Permalink to “Cache 新增 Memory 驱动”">​</a></h3><p>Version: v1.9.0</p><p><code>config/cache.go</code> 新增 <code>memory</code> 配置：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>&quot;stores&quot;: map[string]any{</span></span>
<span class="line"><span>  // 新增</span></span>
<span class="line"><span>  &quot;memory&quot;: map[string]any{</span></span>
<span class="line"><span>    &quot;driver&quot;: &quot;memory&quot;,</span></span>
<span class="line"><span>  },</span></span>
<span class="line"><span>},</span></span></code></pre></div><p><a href="https://github.com/goravel/goravel/blob/v1.9.x/config/cache.go" target="_blank" rel="noreferrer">详见文件</a></p><h3 id="orm-新增分页方法" tabindex="-1">Orm 新增分页方法 <a class="header-anchor" href="#orm-新增分页方法" aria-label="Permalink to “Orm 新增分页方法”">​</a></h3><p>Version: v1.9.0</p><p><code>facades.Orm</code> 新增 <code>Paginate</code> 方法，<a href="./../orm/getting-started.html#分页">详见文档</a>。</p><h3 id="新增-make-命令" tabindex="-1">新增 make 命令 <a class="header-anchor" href="#新增-make-命令" aria-label="Permalink to “新增 make 命令”">​</a></h3><p>Version: v1.9.0</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span>// 创建控制器</span></span>
<span class="line"><span>go run . artisan make:controller UserController</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 创建 HTTP 中间件</span></span>
<span class="line"><span>go run . artisan make:middleware Cors</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// 创建模型</span></span>
<span class="line"><span>go run . artisan make:model User</span></span></code></pre></div><h3 id="response-新增方法" tabindex="-1">Response 新增方法 <a class="header-anchor" href="#response-新增方法" aria-label="Permalink to “Response 新增方法”">​</a></h3><p>Version: v1.9.0</p><table tabindex="0"><thead><tr><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>Data</td><td><a href="./../the-basics/response.html#自定义返回">自定义返回</a></td></tr><tr><td>Redirect</td><td><a href="./../the-basics/response.html#重定向">重定向</a></td></tr></tbody></table><h3 id="request-prepareforvalidation-方法新增-error-返回" tabindex="-1">Request PrepareForValidation 方法新增 error 返回 <a class="header-anchor" href="#request-prepareforvalidation-方法新增-error-返回" aria-label="Permalink to “Request PrepareForValidation 方法新增 error 返回”">​</a></h3><p>Version: v1.9.0</p><p>如果你使用到了 <a href="./../the-basics/validation.html#验证前格式化数据">表单验证中的 PrepareForValidation 方法</a>，请新增返回值：<code>PrepareForValidation(data validation.Data) error</code>。</p><h3 id="file-获取错误的文件类型" tabindex="-1">File 获取错误的文件类型 <a class="header-anchor" href="#file-获取错误的文件类型" aria-label="Permalink to “File 获取错误的文件类型”">​</a></h3><p>Version: v1.9.0</p><p>修复 <code>.docx</code>, <code>.xlsx</code> 等类型错误的识别为 <code>.zip</code> 的问题。</p><h3 id="修复-make-event-和-make-listener-命令生成模板有误的问题" tabindex="-1">修复 make:event 和 make:listener 命令生成模板有误的问题 <a class="header-anchor" href="#修复-make-event-和-make-listener-命令生成模板有误的问题" aria-label="Permalink to “修复 make:event 和 make:listener 命令生成模板有误的问题”">​</a></h3><p>Version: v1.9.0</p><p><code>import &quot;github.com/goravel/framework/contracts/events&quot;</code> 改为 <code>import &quot;github.com/goravel/framework/contracts/event&quot;</code></p><h3 id="修复保存文件时有些类型无法获取后缀的问题" tabindex="-1">修复保存文件时有些类型无法获取后缀的问题 <a class="header-anchor" href="#修复保存文件时有些类型无法获取后缀的问题" aria-label="Permalink to “修复保存文件时有些类型无法获取后缀的问题”">​</a></h3><p>Version: v1.9.1</p><p>下面代码有些类型无法获取后缀:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;upload&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,51)]))}const m=e(n,[["render",l]]);export{k as __pageData,m as default};
