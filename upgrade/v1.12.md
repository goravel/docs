# Upgrading To v1.12 From v1.11

[[toc]]

### Exciting New Features üéâ

- [Service Container(1.12.0)](#service-container)
- [Package Development(1.12.0)](#package-development)

## Enhancements üöÄ

- [Artisan Flag Adds New Methods](#artisan-flag-adds-new-methods)
- [Add Helpers Methods](#add-helpers-method)
- [Upgrade Dependencies](#upgrade-dependencies)
- [Migration Adds New Methods](#migration-adds-new-methods)
- [Some `make` Commands Support Subdirectories](#some--make--commands-support-subdirectories)

## Breaking Changes üõ†

- [Modify The Calling Type Of Facades(1.12.0)](#5--modify-facades-*)
- [Optimize Artisan Flag(1.12.0)](#6--modify-flag-in-the-artisan-command-if-using)
- [Filesystem Module Cancels Default Support For S3, OSS, COS, Minio](#7--filesystem-module-cancels-default-support-for-s3--oss--cos--minio)
- [Cache Module Cancels Default Support For Redis](#8--cache-module-cancels-default-support-for-redis)

## Upgrade Guide

Please upgrade the framework step by step according to the content in this section.

**Estimated Upgrade Time: 10 Minutes**

### 1. Updating Dependencies

Update dependencies in the `go.mod` file:

```
go get -u github.com/goravel/framework@v1.12.0 && go mod tidy
```

### 2. Modify `bootstrap/app.go`

```go
// Before
app := foundation.Application{}

// After
app := foundation.NewApplication()
```

### 3. Modify `app/providers/*` 

Add import for all files:

```go
import (
  "github.com/goravel/framework/contracts/foundation"
)
```

All of `Register`, `Boot` methods Add `app foundation.Application` input parameter:

```go
func (receiver *AppServiceProvider) Register(app foundation.Application) {}

func (receiver *AppServiceProvider) Boot(app foundation.Application) {}
```

### 4. Modify `app/config/*` 

Modify import: 

```go
// Before
"github.com/goravel/framework/contracts"

// After
"github.com/goravel/framework/contracts/foundation"
```

### 5. Modify facades.*

| Before        | After           |
| -----------  | -------------- |
| `facades.Artisan`    | `facades.Artisan()`     |
| `facades.Auth`    | `facades.Auth()`     |
| `facades.Cache`    | `facades.Cache()`     |
| `facades.Config`    | `facades.Config()`     |
| `facades.Crypt`    | `facades.Crypt()`     |
| `facades.Orm`    | `facades.Orm()`     |
| `facades.Event`    | `facades.Event()`     |
| `facades.Grpc`    | `facades.Grpc()`     |
| `facades.Hash`    | `facades.Hash()`     |
| `facades.Http`    | `facades.Http()`     |
| `facades.Log`    | `facades.Log()`     |
| `facades.Mail`    | `facades.Mail()`     |
| `facades.Queue`    | `facades.Queue()`     |
| `facades.Route`    | `facades.Route()`     |
| `facades.Schedule`    | `facades.Schedule()`     |
| `facades.Validation`    | `facades.Validation()`     |

### 6. Modify Flag in the Artisan command(If using)

The items in the `[]command.Flag` add `&command.StringFlag` type:

```go
// Before
func (receiver *VendorPublishCommand) Extend() command.Extend {
  return command.Extend{
    Category: "test",
    Flags: []command.Flag{
      {
        Name: "test",
      },
    },
  }
}

// After
func (receiver *VendorPublishCommand) Extend() command.Extend {
  return command.Extend{
    Category: "test",
    Flags: []command.Flag{
      &command.StringFlag{
        Name: "test",
      },
    },
  }
}
```

### 7. Filesystem Module Cancels Default Support For S3, OSS, COS, Minio

In order to reduce the loading of unnecessary third packages, reduce package volume, and improve compilation efficiency, Goravel will gradually strip each module driver into an independent expansion packages. In this upgrade, the `Filesystem` module cancels the default support for `S3`, `OSS`, `COS`, `Minio` drivers, and transfers support to independent extension packages.

Removes keys in `config/filesystems.go::disks` expect `local`:

```go
// Modified
"disks": map[string]any{
  "local": map[string]any{
    "driver": "local",
    "root":   "storage/app",
    "url":    config.Env("APP_URL", "").(string) + "/storage",
  },
},
```

If you are using other drivers expect `local`, please refer to the corresponding driver documentation for installation:

| Driver       | Link           |
| -----------  | -------------- |
| S3           | https://github.com/goravel/s3     |
| OSS          | https://github.com/goravel/oss     |
| COS          | https://github.com/goravel/cos     |
| Minio        | https://github.com/goravel/minio     |

### 8. Cache Module Cancels Default Support For Redis

Remove the `redis` key in `config/cache.go::stores`:

```go
// Modified
"stores": map[string]any{
  "memory": map[string]any{
    "driver": "memory",
  },
},
```

If you are using the `redis` driver, please refer to the `redis` driver documentation for installation:

| Driver       | Link           |
| -----------  | -------------- |
| Redis        | https://github.com/goravel/redis     |

## Function Introduction

### Service Container

Version: v1.12.0

All services in Goravel are registered in the service container, providing strong support for the package development, [For Detail](../architecutre-concepts/service-container.md)

### Package Development

Version: v1.12.0

Packages are the primary way of adding functionality to Goravel, can enrich the ecology of Goravel, [For Detail](../digging-deeper/package-development.md)

### Artisan Flag Adds New Methods

Version: v1.12.0

Add methods to get different types of `Flag`, [For Detail](../digging-deeper/artisan-console.md#options)

### Add Helpers Methods

Version: v1.12.0

Add `path` and `carbon` Helpers methods, you can easily get the path information and deal with time in project, [For Detail](../digging-deeper/helpers.md)„ÄÇ

### Upgrade Dependencies

Version: v1.12.0

To provide better feature support, the versions of all packages that Goravel depends on have been upgraded.

### Migration Adds New Methods

Version: v1.12.0

| Commands        | Action           |
| -----------     | -------------- |
| migrate:fresh   | Drop all tables and re-run all migrations     |
| migrate:refresh | Reset and re-run all migrations     |
| migrate:reset   | Rollback all database migrations     |
| migrate:status  | Show the status of each migration    |

### Some `make` Commands Support Subdirectories

Version: v1.12.0

| ÂëΩ‰ª§                                 | ÁîüÊàêÊñá‰ª∂                              |
| ----------------------              | ------------------------------------ |
| make:policy User/AuthPolicy         | app/policies/User/auth_policy.go     |
| make:command Goravel/CleanCache     | app/console/commands/Goravel/clean_cache.go     |
| make:model User/Phone               | app/models/User/phone.go     |
| make:observer User/PhoneObserver    | app/observers/User/phone_observer.go     |
| make:event User/GoravelEvent        | app/events/User/goravel_event.go     |
| make:listener User/GoravelListen    | app/listeners/User/goravel_listen.go     |
| make:controller User/AuthController | app/http/controllers/User/auth_controller.go     |
| make:middleware User/Auth           | app/http/middleware/User/auth.go     |
| make:request User/Auth              | app/http/requests/User/auth.go     |
| make:job Goravel/Job                | app/jobs/Goravel/job.go    |
| make:rule User/Phone                | app/rules/User/phone.go     |
